@if (collapsed() && label()) {
  <li
    class="nav-menu-container {{appearance()}}"
    rteTooltip
    rteTooltipPosition="right"
    rteTooltipAlignment="center"
    [rteTooltipGap]="12"
    [ngClass]="{ collapsed: collapsed(), open: open(), nested: isNested() }"
    [rteTooltip]="label()"
    [rteTooltipArrow]="false"
    [rteTooltipShouldFocusTrigger]="false">
    <ng-container [ngTemplateOutlet]="menuContentTemplate"></ng-container>
    <ng-container [ngTemplateOutlet]="nestedMenuTemplate"></ng-container>
  </li>
} @else {
  <li
    class="nav-menu-container {{appearance()}}"
    [ngClass]="{ collapsed: collapsed(), open: open(), nested: isNested() }">
    <ng-container [ngTemplateOutlet]="menuContentTemplate"></ng-container>
    <ng-container [ngTemplateOutlet]="nestedMenuTemplate"></ng-container>
  </li>
}

<ng-template #menuContentTemplate>
  @if (link()) {
    <a
      class="nav-menu"
      [href]="link()!"
      [attr.tabindex]="tabIndex()"
      [attr.aria-label]="label()"
      (click)="toggleMenu()">
      <div class="menu-content-left">
        @if (showIcon() && icon()) {
          <rte-icon class="icon" [name]="icon()!" [size]="iconSize()" />
        }
        @if (!collapsed()) {
          <span>{{ label() }}</span>
        }
      </div>
      <div class="menu-content-right">
        @if (badge()) {
          <rte-badge
            [badgeType]="badge()!.badgeType || 'brand'"
            [badgeSize]="badge()!.size || 'm'"
            [badgeContent]="badge()!.content || 'number'"
            [count]="badge()!.count"
            [icon]="badge()!.icon || 'notification'"
            [simpleBadge]="true"
          />
        }
        @if (shouldShowMenu() && showMenuIcon()) {
          <rte-icon name="arrow-chevron-right" class="menu-icon" [ngClass]="{ 'menu-icon-open': open() }" />
        }
      </div>
    </a>
  } @else {
    <span
      class="nav-menu"
      [attr.tabindex]="tabIndex()"
      [attr.aria-label]="label()"
      (click)="toggleMenu()"
      (keydown)="handleKeyDown($event)">
      <div class="menu-content-left">
        @if (showIcon() && icon()) {
          <rte-icon class="icon" [name]="icon()!" [size]="iconSize()" />
        }
        @if (!collapsed()) {
          <span>{{ label() }}</span>
        }
      </div>
      <div class="menu-content-right">
        @if (badge()) {
          <rte-badge
            [badgeType]="badge()!.badgeType || 'brand'"
            [badgeSize]="badge()!.size || 'm'"
            [badgeContent]="badge()!.content || 'number'"
            [count]="badge()!.count"
            [icon]="badge()!.icon || 'notification'"
            [simpleBadge]="true"
          />
        }
        @if (shouldShowMenu() && showMenuIcon()) {
          <rte-icon name="arrow-chevron-right" class="menu-icon" [ngClass]="{ 'menu-icon-open': open() }" />
        }
      </div>
    </span>
  }
</ng-template>

<ng-template #nestedMenuTemplate>
  @if (shouldShowMenu()) {
    <ul class="nested-menu" [ngClass]="{ 'nested-menu-open': open() }">
      @if (open()) {
        @for (item of items(); track item.id || item.label) {
          @if (hasNestedItemsForItem(item)) {
            <rte-nav-menu
              [id]="item.id"
              [label]="item.label"
              [icon]="item.icon"
              [showIcon]="item.showIcon ?? true"
              [collapsed]="collapsed()"
              [link]="item.link"
              [items]="item.items || []"
              [showMenuIcon]="showMenuIcon()"
              [isNested]="true"
              [open]="item.open"
              [parentMenuOpen]="open()"
              [appearance]="appearance()"
              [showDivider]="item.showDivider!"
              [badge]="item.badge"
              (itemClick)="handleMenuClick($event)"
              (openChange)="handleMenuOpenChange($event)"
            />
          } @else {
            <li>
              <rte-nav-item
                [id]="item.id"
                [label]="item.label"
                [icon]="item.icon"
                [showIcon]="item.showIcon ?? true"
                [collapsed]="collapsed()"
                [link]="item.link"
                [isNested]="true"
                [parentMenuOpen]="open()"
                [appearance]="appearance()"
                [showDivider]="item.showDivider!"
                [badge]="item.badge"
                (itemClick)="itemClick.emit($event)" />
            </li>
            @if (item.showDivider) {
              <rte-divider [appearance]="dividerAppearance()" />
            }
          }
        }
      }
    </ul>
  }
</ng-template>

@if (showDivider()) {
  <rte-divider [appearance]="dividerAppearance()" />
}


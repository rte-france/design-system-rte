import{j as s}from"./jsx-runtime-Cf8x2fCZ.js";import{T as N,S as P,E as H,c as M,d as $,e as F}from"./keyboard.constants-YQ0IdItO.js";import{r as d}from"./index-G8LIXM5I.js";import{u as Z}from"./useActiveKeyboard-CyCI8mio.js";import{D as z}from"./Divider-B0TD5a92.js";import{I as S}from"./Icon-DjEid3Hw.js";import{u as fe,b as G,c as J,a as Q,O as we}from"./Overlay-BozqJJVk.js";import{c as ye}from"./index-DSdvzt-y.js";let D={};const h={};class l{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return D[e]||!1}static open(e){D[e]=!0,this.notifyListeners(e)}static close(e){delete D[e],this.notifyListeners(e)}static closeAll(){D={},Object.values(h).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(D)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(D).filter(a=>a.startsWith(e)&&a!==e).forEach(a=>l.close(a))}static subscribe(e,t){return h[e]||(h[e]=[]),h[e].push(t),()=>{h[e]=h[e].filter(n=>n!==t)}}static notifyListeners(e){var t;(t=h[e])==null||t.forEach(n=>n())}}const U=d.createContext(void 0),ee=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:n})=>s.jsx(U.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:n});ee.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const ve="_trigger_k2759_3",ge="_dropdown_k2759_15",q={trigger:ve,dropdown:ge,"dropdown-items":"_dropdown-items_k2759_40"},X=r=>{var n;const e=te(r),t=e.findIndex(a=>a===document.activeElement);t<e.length-1?e[t+1].focus():(n=e[0])==null||n.focus()},Ee=r=>{var n;const e=te(r),t=e.findIndex(a=>a===document.activeElement);t>0?e[t-1].focus():(n=e[e.length-1])==null||n.focus()},xe=r=>{var t;const e=document.querySelector(`[data-dropdown-id='${r}']`);e&&((t=(e==null?void 0:e.querySelectorAll('li[role="menuitem"]'))[0])==null||t.focus())},he=r=>{var n;const e=l.getParentDropdownId(r),t=document.querySelector(`[data-dropdown-id='${e}']`);(n=t==null?void 0:t.querySelector("[data-active=true]"))==null||n.focus()},te=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},oe=r=>{const e=d.useRef(r||l.generateId()),[t,n]=d.useState(!1);d.useEffect(()=>l.subscribe(e.current,()=>{n(l.isOpen(e.current))}),[]);const a=()=>{l.open(e.current)},u=()=>{l.close(e.current)},v=()=>{t?u():a()};return{dropdownId:e.current,isOpen:t,open:a,close:u,toggle:v}},ne=d.forwardRef(({trigger:r,className:e,style:t,dropdownId:n,hasParent:a,position:u="bottom",autoClose:v=!0,isOpen:y=!1,onClose:j=()=>{},children:p,offset:g=0,..._},m)=>{const{dropdownId:E}=oe(n),[k,R]=d.useState(u),{closeRoot:I}=d.useContext(U)||{},b=d.useRef(null),T=d.useRef(null),[c,K]=d.useState(null),[i,se]=d.useState(null),[V,Y]=d.useState({top:500,left:500}),{shouldRender:re,isAnimating:ae}=fe(y,150),de=d.useCallback(o=>{T.current=o,K(o),typeof m=="function"?m(o):m&&(m.current=o)},[m]),ie=d.useCallback(o=>{b.current=o,se(o)},[]),O=d.useCallback(()=>{a&&I?I():j(),l.closeAll()},[I,a,j]),ce=o=>{if(o.key===M||o.key===$){if(o.stopPropagation(),o.preventDefault(),c===null)return;o.key===M?X(c):Ee(c)}o.key===F&&O()},le=o=>{if(o.key===N){if(c===null)return;o.preventDefault(),X(c)}},{onKeyDown:ue,onKeyUp:pe}=Z({onKeyUp:ce},{interactiveKeyCodes:[P,H,N,M,$,F]});d.useEffect(()=>{const o=f=>{var A;const w=f.target,x=document.querySelectorAll("[data-dropdown-id]");Array.from(x).some(me=>me.contains(w))||((A=b.current)==null?void 0:A.contains(w))||O()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[O]);const W=d.useCallback((o,f)=>{const w=G(o,f,"right",g,!0),x=J(o,f,w),L=Q(w,o,f,g,x);R(w),Y(L)},[g]),B=d.useCallback((o,f,w)=>{const x=w==="auto"?G(o,f,"bottom"):w,L=J(o,f,x),A=Q(x,o,f,g,L);R(x),Y(A)},[g]);return d.useEffect(()=>{y&&(!i||!c||(a?W(i,c):B(i,c,u)))},[y,a,c,i,u,W,B]),s.jsxs(ee,{dropdownId:E,closeRoot:O,autoClose:v,children:[s.jsx("div",{ref:ie,className:q.trigger,tabIndex:-1,onKeyDown:le,children:r}),re&&s.jsx(we,{children:s.jsx("div",{className:ye(q.dropdown,e),"data-dropdown-id":E,"data-position":k,"data-open":ae||void 0,..._,style:{...t,top:V.top,left:V.left},ref:de,onKeyUp:pe,onKeyDown:ue,children:s.jsx("ul",{className:q["dropdown-items"],role:"menu",children:p})})})]})});ne.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const C={"dropdown-item":"_dropdown-item_h8tgc_3","dropdown-divider":"_dropdown-divider_h8tgc_40"},Ce=({label:r,leftIcon:e,trailingText:t,disabled:n,hasSeparator:a,hasIndent:u,children:v,onClick:y,...j})=>{const{dropdownId:p,autoClose:g,closeRoot:_}=d.useContext(U)||{},m=`${p}-${r&&r.replace(/\s+/g,"")}`,{isOpen:E,open:k}=oe(m),R=()=>{p&&(l.closeSubMenus(p),k())},I=()=>{p&&l.closeSubMenus(p)};u&&e&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${e}' for dropdownitem with label '${r}' without indentation.`);const b=i=>{n||(y&&y(i),g&&_&&_())},T=i=>{if(i.preventDefault(),i.key===N&&(E&&xe(m),i.shiftKey&&p&&he(p)),i.key===H||i.key===P){if(n)return;y&&b(i),v&&k()}},{onKeyUp:c,onFocus:K}=Z({onKeyUp:T,onFocus:I},{interactiveKeyCodes:[P,H,N,M,$,F]});return v?s.jsx(ne,{hasParent:!0,dropdownId:m,isOpen:E,trigger:s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:C["dropdown-item"],"data-active":E,"data-disabled":n,role:"menuitem",onMouseOver:R,onKeyUp:c,onFocus:K,tabIndex:0,children:[u&&s.jsx("span",{style:{width:"20px"}}),e&&s.jsx(S,{name:e,className:C["dropdown-item-icon"],appearance:E?"filled":"outlined"}),s.jsx("span",{style:{flex:"2"},children:r}),s.jsx(S,{name:"arrow-chevron-right",className:C["dropdown-item-icon"]})]}),a&&s.jsx("div",{className:C["dropdown-divider"],children:s.jsx(z,{})})]}),children:v}):s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:C["dropdown-item"],"data-disabled":n,role:"menuitem",onClick:b,onMouseOver:R,onKeyUp:c,onFocus:K,tabIndex:0,...j,children:[u&&!e&&s.jsx("span",{style:{width:"20px"}}),e&&s.jsx(S,{name:e,className:C["dropdown-item-icon"]}),s.jsx("span",{style:{flex:"2"},children:r}),t&&s.jsx("div",{children:t})]}),a&&s.jsx("div",{className:C["dropdown-divider"],children:s.jsx(z,{})})]})};Ce.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEventHandler<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEventHandler<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEventHandler",raw:"React.KeyboardEventHandler<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{ne as D,Ce as a};

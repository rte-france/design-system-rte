import{j as o}from"./jsx-runtime-Cf8x2fCZ.js";import{s as Ee,B as De}from"./Badge-CQk6fGHb.js";import{T as B,E as Z,b as Y,d as ee,c as te,S as re}from"./keyboard.constants-BverKK8B.js";import{r as d}from"./index-G8LIXM5I.js";import{u as le}from"./useActiveKeyboard-DaOmFJe_.js";import{D as W}from"./Divider-cNGLKJiC.js";import{I as X}from"./Icon-DjEid3Hw.js";import{c as ae,b as de,a as ie}from"./auto-placement-C6RxYMtA.js";import{u as Re}from"./useAnimatedMount-_zPBpYOt.js";import{O as _e}from"./Overlay-CQ0GhNxd.js";import{c as F}from"./index-DSdvzt-y.js";const Ie=150;let I={};const D={};class u{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return I[e]||!1}static open(e){I[e]=!0,this.notifyListeners(e)}static close(e){delete I[e],this.notifyListeners(e)}static closeAll(){I={},Object.values(D).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(I)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(I).filter(s=>s.startsWith(e)&&s!==e).forEach(s=>u.close(s))}static subscribe(e,t){return D[e]||(D[e]=[]),D[e].push(t),()=>{D[e]=D[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=D[e])==null||t.forEach(a=>a())}}const oe=d.createContext(void 0),ue=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>o.jsx(oe.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});ue.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const je="_trigger_19dwi_1",Ce="_dropdown_19dwi_13",j={trigger:je,dropdown:Ce,"dropdown-menu-header":"_dropdown-menu-header_19dwi_39","dropdown-menu-content":"_dropdown-menu-content_19dwi_39","dropdown-menu-footer":"_dropdown-menu-footer_19dwi_39","dropdown-items":"_dropdown-items_19dwi_42"},ce=r=>{var a;const e=me(r),t=e.findIndex(s=>s===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},Ne=r=>{var a;const e=me(r),t=e.findIndex(s=>s===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},pe=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},be=r=>{var s;const e=u.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(s=a==null?void 0:a.querySelector("[data-active=true]"))==null||s.focus()},me=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},fe=r=>{const e=d.useRef(r||u.generateId()),[t,a]=d.useState(!1);d.useEffect(()=>u.subscribe(e.current,()=>{a(u.isOpen(e.current))}),[]);const s=()=>{u.open(e.current)},p=()=>{u.close(e.current)},v=()=>{t?p():s()};return{dropdownId:e.current,isOpen:t,open:s,close:p,toggle:v}},we=d.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:s,position:p="bottom",autoClose:v=!0,isOpen:w=!1,onClose:C=()=>{},children:T,offset:y=0,alignment:A="start",autofocus:S=!0,header:q,footer:L,...N},h)=>{const{dropdownId:c}=fe(a),[z,b]=d.useState(p),{closeRoot:x}=d.useContext(oe)||{},g=d.useRef(null),M=d.useRef(null),[i,G]=d.useState(null),[E,J]=d.useState(null),[P,K]=d.useState({top:500,left:500}),{shouldRender:k,isAnimating:H}=Re(w,Ie),l=d.useCallback(n=>{M.current=n,G(n),typeof h=="function"?h(n):h&&(h.current=n)},[h]),U=d.useCallback(n=>{g.current=n,J(n)},[]),V=d.useCallback(()=>{s&&x?x():C(),u.closeAll()},[x,s,C]),ye=n=>{if(n.key===Y||n.key===ee){if(n.stopPropagation(),n.preventDefault(),i===null)return;n.key===Y?ce(i):Ne(i)}},ve=n=>{n.key===te&&V()},he=n=>{if(n.key===B){if(i===null)return;n.preventDefault(),ce(i)}},{onKeyDown:xe,onKeyUp:ge}=le({onKeyUp:ve,onKeyDown:ye},{interactiveKeyCodes:[Z,B,Y,ee,te]});d.useEffect(()=>{const n=m=>{var $;const f=m.target,O=document.querySelectorAll("[data-dropdown-id]");Array.from(O).some(Q=>Q.contains(f))||(($=g.current)==null?void 0:$.contains(f))||V()};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[V]);const ne=d.useCallback((n,m)=>{const f=ae(n,m,"right",y,!0),O=de(n,m,f),_=ie(f,n,m,y,O);b(f),K(_)},[y]),se=d.useCallback((n,m,f,O)=>{const _=f==="auto"?ae(n,m,"bottom"):f,$=O??de(n,m,_),Q=ie(_,n,m,y,$);b(_),K(Q)},[y]);return d.useEffect(()=>{!E||!i||(s?ne(E,i):se(E,i,p,A))},[s,i,E,p,A,ne,se]),d.useEffect(()=>{w&&i&&S&&pe(c)},[w,c,i,S]),o.jsxs(ue,{dropdownId:c,closeRoot:V,autoClose:v,children:[o.jsx("div",{ref:U,className:j.trigger,tabIndex:-1,onKeyDown:he,children:r}),k&&o.jsx(_e,{children:o.jsxs("div",{className:F(j.dropdown,e),"data-dropdown-id":c,"data-position":z,"data-open":H||void 0,...N,style:{...t,top:P.top,left:P.left},ref:l,onKeyUp:ge,onKeyDown:xe,children:[q&&o.jsxs("div",{className:F(j["dropdown-menu-header"],"rte-dropdown-menu-header"),children:[q,o.jsx(W,{})]}),o.jsx("div",{className:F(j["dropdown-menu-content"],"rte-dropdown-menu-content"),children:o.jsx("ul",{className:j["dropdown-items"],role:"menu",children:T})}),L&&o.jsxs("div",{className:F(j["dropdown-menu-footer"],"rte-dropdown-menu-footer"),children:[o.jsx(W,{}),L]})]})})]})});we.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},header:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},footer:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const R={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},Ke=({label:r,link:e,leftIcon:t,trailingText:a,disabled:s,hasSeparator:p,hasIndent:v,children:w,badgeCount:C,badgeContent:T,badgeIcon:y,badgeType:A,badgeSize:S,showBadge:q,isSelected:L,onClick:N,...h})=>{const{dropdownId:c,autoClose:z,closeRoot:b}=d.useContext(oe)||{},x=`${c}-${r&&r.replace(/\s+/g,"")}`,{isOpen:g,open:M}=fe(x),i=()=>{c&&(u.closeSubMenus(c),M())},G=()=>{c&&u.closeSubMenus(c)};v&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const E=l=>{s||(N&&N(l),z&&b&&b())},J=l=>{if([re,Z].includes(l.key))if(e){const U=l.currentTarget.querySelector("a");U&&U.click()}else{if(s)return;N&&E(l),w&&M()}},P=l=>{l.preventDefault(),l.key===B&&(g&&pe(x),l.shiftKey&&c&&be(c))},{onKeyUp:K,onFocus:k,onKeyDown:H}=le({onKeyUp:P,onFocus:G,onKeyDown:J},{interactiveKeyCodes:[re,Z,B,Y,ee,te]});return w?o.jsx(we,{hasParent:!0,dropdownId:x,isOpen:g,trigger:o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:R["dropdown-item"],"data-active":g,"data-disabled":s,role:"menuitem",onMouseOver:i,onKeyUp:K,onKeyDown:H,onFocus:k,tabIndex:0,children:[v&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(X,{name:t,className:R["dropdown-item-icon"],appearance:g?"filled":"outlined"}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):o.jsx("span",{style:{flex:"2"},children:r}),o.jsx(X,{name:"arrow-chevron-right",className:R["dropdown-item-icon"]})]}),p&&o.jsx("div",{className:R["dropdown-divider"],children:o.jsx(W,{})})]}),children:w}):o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:R["dropdown-item"],"data-disabled":s,"data-active":L,role:"menuitem",onClick:E,onMouseOver:i,onKeyUp:K,onKeyDown:H,onFocus:k,tabIndex:0,...h,children:[v&&!t&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(X,{name:t,className:R["dropdown-item-icon"]}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):o.jsx("span",{style:{flex:"2"},children:r}),a&&o.jsx("div",{children:a}),Ee({showBadge:!!q,badgeContent:T,badgeCount:C,badgeIcon:y})&&o.jsx(De,{count:C,content:T,icon:y,badgeType:A,size:S})]}),p&&o.jsx("div",{className:R["dropdown-divider"],children:o.jsx(W,{})})]})};Ke.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{we as D,Ke as a};

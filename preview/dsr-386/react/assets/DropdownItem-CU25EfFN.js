import{j as n}from"./jsx-runtime-Cf8x2fCZ.js";import{s as ge,B as he}from"./Badge-CR2JMPaF.js";import{T as S,S as J,E as Q,c as H,d as X,b as Z}from"./keyboard.constants-ep-ZHn_7.js";import{r as i}from"./index-G8LIXM5I.js";import{u as ie}from"./useActiveKeyboard-BPEscCvd.js";import{D as ne}from"./Divider-cNGLKJiC.js";import{I as W}from"./Icon-DjEid3Hw.js";import{c as se,b as re,a as ae}from"./auto-placement-C6RxYMtA.js";import{u as xe}from"./useAnimatedMount-_zPBpYOt.js";import{O as Ee}from"./Overlay-CtOPxSY4.js";import{c as De}from"./index-DSdvzt-y.js";let C={};const E={};class l{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return C[e]||!1}static open(e){C[e]=!0,this.notifyListeners(e)}static close(e){delete C[e],this.notifyListeners(e)}static closeAll(){C={},Object.values(E).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(C)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(C).filter(s=>s.startsWith(e)&&s!==e).forEach(s=>l.close(s))}static subscribe(e,t){return E[e]||(E[e]=[]),E[e].push(t),()=>{E[e]=E[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=E[e])==null||t.forEach(a=>a())}}const ee=i.createContext(void 0),ce=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>n.jsx(ee.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});ce.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Re="_trigger_e61q5_1",Ce="_dropdown_e61q5_13",z={trigger:Re,dropdown:Ce,"dropdown-items":"_dropdown-items_e61q5_39"},G=r=>{var a;const e=le(r),t=e.findIndex(s=>s===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},Ie=r=>{var a;const e=le(r),t=e.findIndex(s=>s===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},de=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},je=r=>{var s;const e=l.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(s=a==null?void 0:a.querySelector("[data-active=true]"))==null||s.focus()},le=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},ue=r=>{const e=i.useRef(r||l.generateId()),[t,a]=i.useState(!1);i.useEffect(()=>l.subscribe(e.current,()=>{a(l.isOpen(e.current))}),[]);const s=()=>{l.open(e.current)},p=()=>{l.close(e.current)},g=()=>{t?p():s()};return{dropdownId:e.current,isOpen:t,open:s,close:p,toggle:g}},pe=i.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:s,position:p="bottom",autoClose:g=!0,isOpen:w=!1,onClose:I=()=>{},children:q,offset:y=0,alignment:L="start",...$},h)=>{const{dropdownId:v}=ue(a),[F,u]=i.useState(p),{closeRoot:j}=i.useContext(ee)||{},K=i.useRef(null),b=i.useRef(null),[c,T]=i.useState(null),[x,V]=i.useState(null),[_,A]=i.useState({top:500,left:500}),{shouldRender:Y,isAnimating:M}=xe(w,150),N=i.useCallback(o=>{b.current=o,T(o),typeof h=="function"?h(o):h&&(h.current=o)},[h]),k=i.useCallback(o=>{K.current=o,V(o)},[]),d=i.useCallback(()=>{s&&j?j():I(),l.closeAll()},[j,s,I]),P=o=>{if(o.key===H||o.key===X){if(o.stopPropagation(),o.preventDefault(),c===null)return;o.key===H?G(c):Ie(c)}},me=o=>{o.key===Z&&d()},fe=o=>{if(o.key===S){if(c===null)return;o.preventDefault(),G(c)}},we=o=>{if(o.key===S){if(c===null)return;o.preventDefault(),G(c)}},{onKeyDown:ye,onKeyUp:ve}=ie({onKeyUp:me,onKeyDown:P},{interactiveKeyCodes:[J,Q,S,H,X,Z]});i.useEffect(()=>{const o=m=>{var U;const f=m.target,O=document.querySelectorAll("[data-dropdown-id]");Array.from(O).some(B=>B.contains(f))||((U=K.current)==null?void 0:U.contains(f))||d()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[d]);const te=i.useCallback((o,m)=>{const f=se(o,m,"right",y,!0),O=re(o,m,f),R=ae(f,o,m,y,O);u(f),A(R)},[y]),oe=i.useCallback((o,m,f,O)=>{const R=f==="auto"?se(o,m,"bottom"):f,U=O??re(o,m,R),B=ae(R,o,m,y,U);u(R),A(B)},[y]);return i.useEffect(()=>{!x||!c||(s?te(x,c):oe(x,c,p,L))},[s,c,x,p,L,te,oe]),i.useEffect(()=>{w&&c&&de(v)},[w,v,c]),n.jsxs(ce,{dropdownId:v,closeRoot:d,autoClose:g,children:[n.jsx("div",{ref:k,className:z.trigger,tabIndex:-1,onKeyDown:fe,onKeyUp:we,children:r}),Y&&n.jsx(Ee,{children:n.jsx("div",{className:De(z.dropdown,e),"data-dropdown-id":v,"data-position":F,"data-open":M||void 0,...$,style:{...t,top:_.top,left:_.left},ref:N,onKeyUp:ve,onKeyDown:ye,children:n.jsx("ul",{className:z["dropdown-items"],role:"menu",children:q})})})]})});pe.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1}},composes:["CoreDropdownProps"]};const D={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},Ke=({label:r,link:e,leftIcon:t,trailingText:a,disabled:s,hasSeparator:p,hasIndent:g,children:w,badgeCount:I,badgeContent:q,badgeIcon:y,badgeType:L,badgeSize:$,showBadge:h,onClick:v,...F})=>{const{dropdownId:u,autoClose:j,closeRoot:K}=i.useContext(ee)||{},b=`${u}-${r&&r.replace(/\s+/g,"")}`,{isOpen:c,open:T}=ue(b),x=()=>{u&&(l.closeSubMenus(u),T())},V=()=>{u&&l.closeSubMenus(u)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const _=d=>{s||(v&&v(d),j&&K&&K())},A=d=>{if([J,Q].includes(d.key))if(e){const P=d.currentTarget.querySelector("a");P&&P.click()}else{if(s)return;v&&_(d),w&&T()}},Y=d=>{d.preventDefault(),d.key===S&&(c&&de(b),d.shiftKey&&u&&je(u))},{onKeyUp:M,onFocus:N,onKeyDown:k}=ie({onKeyUp:Y,onFocus:V,onKeyDown:A},{interactiveKeyCodes:[J,Q,S,H,X,Z]});return w?n.jsx(pe,{hasParent:!0,dropdownId:b,isOpen:c,trigger:n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:D["dropdown-item"],"data-active":c,"data-disabled":s,role:"menuitem",onMouseOver:x,onKeyUp:M,onKeyDown:k,onFocus:N,tabIndex:0,children:[g&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(W,{name:t,className:D["dropdown-item-icon"],appearance:c?"filled":"outlined"}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),n.jsx(W,{name:"arrow-chevron-right",className:D["dropdown-item-icon"]})]}),p&&n.jsx("div",{className:D["dropdown-divider"],children:n.jsx(ne,{})})]}),children:w}):n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:D["dropdown-item"],"data-disabled":s,role:"menuitem",onClick:_,onMouseOver:x,onKeyUp:M,onKeyDown:k,onFocus:N,tabIndex:0,...F,children:[g&&!t&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(W,{name:t,className:D["dropdown-item-icon"]}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),a&&n.jsx("div",{children:a}),ge({showBadge:!!h,badgeContent:q,badgeCount:I,badgeIcon:y})&&n.jsx(he,{count:I,content:q,icon:y,badgeType:L,size:$})]}),p&&n.jsx("div",{className:D["dropdown-divider"],children:n.jsx(ne,{})})]})};Ke.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{pe as D,Ke as a};

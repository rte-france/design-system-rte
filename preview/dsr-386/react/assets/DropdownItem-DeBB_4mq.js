import{j as n}from"./jsx-runtime-Cf8x2fCZ.js";import{s as ge,B as he}from"./Badge-CQk6fGHb.js";import{T as U,S as G,E as J,b as F,d as Q,c as X}from"./keyboard.constants-BverKK8B.js";import{r as i}from"./index-G8LIXM5I.js";import{u as ie}from"./useActiveKeyboard-DaOmFJe_.js";import{D as oe}from"./Divider-cNGLKJiC.js";import{I as z}from"./Icon-DjEid3Hw.js";import{c as ne,b as se,a as re}from"./auto-placement-C6RxYMtA.js";import{u as xe}from"./useAnimatedMount-_zPBpYOt.js";import{O as Ee}from"./Overlay-CQ0GhNxd.js";import{c as De}from"./index-DSdvzt-y.js";let K={};const x={};class l{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return K[e]||!1}static open(e){K[e]=!0,this.notifyListeners(e)}static close(e){delete K[e],this.notifyListeners(e)}static closeAll(){K={},Object.values(x).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(K)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(K).filter(s=>s.startsWith(e)&&s!==e).forEach(s=>l.close(s))}static subscribe(e,t){return x[e]||(x[e]=[]),x[e].push(t),()=>{x[e]=x[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=x[e])==null||t.forEach(a=>a())}}const Z=i.createContext(void 0),ce=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>n.jsx(Z.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});ce.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Re="_trigger_obnza_1",Ce="_dropdown_obnza_13",W={trigger:Re,dropdown:Ce,"dropdown-items":"_dropdown-items_obnza_39"},ae=r=>{var a;const e=le(r),t=e.findIndex(s=>s===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},Ie=r=>{var a;const e=le(r),t=e.findIndex(s=>s===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},de=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},je=r=>{var s;const e=l.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(s=a==null?void 0:a.querySelector("[data-active=true]"))==null||s.focus()},le=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},ue=r=>{const e=i.useRef(r||l.generateId()),[t,a]=i.useState(!1);i.useEffect(()=>l.subscribe(e.current,()=>{a(l.isOpen(e.current))}),[]);const s=()=>{l.open(e.current)},u=()=>{l.close(e.current)},g=()=>{t?u():s()};return{dropdownId:e.current,isOpen:t,open:s,close:u,toggle:g}},pe=i.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:s,position:u="bottom",autoClose:g=!0,isOpen:y=!1,onClose:_=()=>{},children:O,offset:v=0,alignment:L="start",autofocus:A=!0,...Y},p)=>{const{dropdownId:D}=ue(a),[m,M]=i.useState(u),{closeRoot:R}=i.useContext(Z)||{},C=i.useRef(null),I=i.useRef(null),[c,N]=i.useState(null),[j,T]=i.useState(null),[q,k]=i.useState({top:500,left:500}),{shouldRender:P,isAnimating:H}=xe(y,150),V=i.useCallback(o=>{I.current=o,N(o),typeof p=="function"?p(o):p&&(p.current=o)},[p]),d=i.useCallback(o=>{C.current=o,T(o)},[]),h=i.useCallback(()=>{s&&R?R():_(),l.closeAll()},[R,s,_]),me=o=>{if(o.key===F||o.key===Q){if(o.stopPropagation(),o.preventDefault(),c===null)return;o.key===F?ae(c):Ie(c)}},fe=o=>{o.key===X&&h()},we=o=>{if(o.key===U){if(c===null)return;o.preventDefault(),ae(c)}},{onKeyDown:ye,onKeyUp:ve}=ie({onKeyUp:fe,onKeyDown:me},{interactiveKeyCodes:[G,J,U,F,Q,X]});i.useEffect(()=>{const o=f=>{var $;const w=f.target,S=document.querySelectorAll("[data-dropdown-id]");Array.from(S).some(B=>B.contains(w))||(($=C.current)==null?void 0:$.contains(w))||h()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[h]);const ee=i.useCallback((o,f)=>{const w=ne(o,f,"right",v,!0),S=se(o,f,w),b=re(w,o,f,v,S);M(w),k(b)},[v]),te=i.useCallback((o,f,w,S)=>{const b=w==="auto"?ne(o,f,"bottom"):w,$=S??se(o,f,b),B=re(b,o,f,v,$);M(b),k(B)},[v]);return i.useEffect(()=>{!j||!c||(s?ee(j,c):te(j,c,u,L))},[s,c,j,u,L,ee,te]),i.useEffect(()=>{y&&c&&A&&de(D)},[y,D,c,A]),n.jsxs(ce,{dropdownId:D,closeRoot:h,autoClose:g,children:[n.jsx("div",{ref:d,className:W.trigger,tabIndex:-1,onKeyDown:we,children:r}),P&&n.jsx(Ee,{children:n.jsx("div",{className:De(W.dropdown,e),"data-dropdown-id":D,"data-position":m,"data-open":H||void 0,...Y,style:{...t,top:q.top,left:q.left},ref:V,onKeyUp:ve,onKeyDown:ye,children:n.jsx("ul",{className:W["dropdown-items"],role:"menu",children:O})})})]})});pe.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const E={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},be=({label:r,link:e,leftIcon:t,trailingText:a,disabled:s,hasSeparator:u,hasIndent:g,children:y,badgeCount:_,badgeContent:O,badgeIcon:v,badgeType:L,badgeSize:A,showBadge:Y,onClick:p,...D})=>{const{dropdownId:m,autoClose:M,closeRoot:R}=i.useContext(Z)||{},C=`${m}-${r&&r.replace(/\s+/g,"")}`,{isOpen:I,open:c}=ue(C),N=()=>{m&&(l.closeSubMenus(m),c())},j=()=>{m&&l.closeSubMenus(m)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const T=d=>{s||(p&&p(d),M&&R&&R())},q=d=>{if([G,J].includes(d.key))if(e){const h=d.currentTarget.querySelector("a");h&&h.click()}else{if(s)return;p&&T(d),y&&c()}},k=d=>{d.preventDefault(),d.key===U&&(I&&de(C),d.shiftKey&&m&&je(m))},{onKeyUp:P,onFocus:H,onKeyDown:V}=ie({onKeyUp:k,onFocus:j,onKeyDown:q},{interactiveKeyCodes:[G,J,U,F,Q,X]});return y?n.jsx(pe,{hasParent:!0,dropdownId:C,isOpen:I,trigger:n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:E["dropdown-item"],"data-active":I,"data-disabled":s,role:"menuitem",onMouseOver:N,onKeyUp:P,onKeyDown:V,onFocus:H,tabIndex:0,children:[g&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(z,{name:t,className:E["dropdown-item-icon"],appearance:I?"filled":"outlined"}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),n.jsx(z,{name:"arrow-chevron-right",className:E["dropdown-item-icon"]})]}),u&&n.jsx("div",{className:E["dropdown-divider"],children:n.jsx(oe,{})})]}),children:y}):n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:E["dropdown-item"],"data-disabled":s,role:"menuitem",onClick:T,onMouseOver:N,onKeyUp:P,onKeyDown:V,onFocus:H,tabIndex:0,...D,children:[g&&!t&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(z,{name:t,className:E["dropdown-item-icon"]}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),a&&n.jsx("div",{children:a}),ge({showBadge:!!Y,badgeContent:O,badgeCount:_,badgeIcon:v})&&n.jsx(he,{count:_,content:O,icon:v,badgeType:L,size:A})]}),u&&n.jsx("div",{className:E["dropdown-divider"],children:n.jsx(oe,{})})]})};be.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{pe as D,be as a};

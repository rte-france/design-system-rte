import{j as n}from"./jsx-runtime-Cf8x2fCZ.js";import{s as ge,B as he}from"./Badge-ySgcnoLk.js";import{T as S,S as G,E as J,c as F,d as Q,b as X}from"./keyboard.constants-ep-ZHn_7.js";import{r as i}from"./index-G8LIXM5I.js";import{u as ae}from"./useActiveKeyboard-BPEscCvd.js";import{D as oe}from"./Divider-GNmPbxh0.js";import{I as B}from"./Icon-DjEid3Hw.js";import{c as ne,b as se,a as re}from"./auto-placement-C6RxYMtA.js";import{u as xe}from"./useAnimatedMount-_zPBpYOt.js";import{O as Ee}from"./Overlay-CtOPxSY4.js";import{c as De}from"./index-DSdvzt-y.js";let b={};const x={};class l{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return b[e]||!1}static open(e){b[e]=!0,this.notifyListeners(e)}static close(e){delete b[e],this.notifyListeners(e)}static closeAll(){b={},Object.values(x).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(b)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(b).filter(s=>s.startsWith(e)&&s!==e).forEach(s=>l.close(s))}static subscribe(e,t){return x[e]||(x[e]=[]),x[e].push(t),()=>{x[e]=x[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=x[e])==null||t.forEach(a=>a())}}const Z=i.createContext(void 0),ie=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>n.jsx(Z.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});ie.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Re="_trigger_1jrnr_29",je="_dropdown_1jrnr_41",W={trigger:Re,dropdown:je,"dropdown-items":"_dropdown-items_1jrnr_67"},z=r=>{var a;const e=de(r),t=e.findIndex(s=>s===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},Ce=r=>{var a;const e=de(r),t=e.findIndex(s=>s===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},ce=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},Ie=r=>{var s;const e=l.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(s=a==null?void 0:a.querySelector("[data-active=true]"))==null||s.focus()},de=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},le=r=>{const e=i.useRef(r||l.generateId()),[t,a]=i.useState(!1);i.useEffect(()=>l.subscribe(e.current,()=>{a(l.isOpen(e.current))}),[]);const s=()=>{l.open(e.current)},u=()=>{l.close(e.current)},g=()=>{t?u():s()};return{dropdownId:e.current,isOpen:t,open:s,close:u,toggle:g}},ue=i.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:s,position:u="bottom",autoClose:g=!0,isOpen:y=!1,onClose:_=()=>{},children:L,offset:v=0,alignment:T="start",...V},p)=>{const{dropdownId:D}=le(a),[m,A]=i.useState(u),{closeRoot:R}=i.useContext(Z)||{},j=i.useRef(null),C=i.useRef(null),[c,M]=i.useState(null),[I,N]=i.useState(null),[q,k]=i.useState({top:500,left:500}),{shouldRender:P,isAnimating:U}=xe(y,150),H=i.useCallback(o=>{C.current=o,M(o),typeof p=="function"?p(o):p&&(p.current=o)},[p]),d=i.useCallback(o=>{j.current=o,N(o)},[]),h=i.useCallback(()=>{s&&R?R():_(),l.closeAll()},[R,s,_]),pe=o=>{if(o.key===F||o.key===Q){if(o.stopPropagation(),o.preventDefault(),c===null)return;o.key===F?z(c):Ce(c)}},me=o=>{o.key===X&&h()},fe=o=>{if(o.key===S){if(c===null)return;o.preventDefault(),z(c)}},we=o=>{if(o.key===S){if(c===null)return;o.preventDefault(),z(c)}},{onKeyDown:ye,onKeyUp:ve}=ae({onKeyUp:me,onKeyDown:pe},{interactiveKeyCodes:[G,J,S,F,Q,X]});i.useEffect(()=>{const o=f=>{var $;const w=f.target,O=document.querySelectorAll("[data-dropdown-id]");Array.from(O).some(Y=>Y.contains(w))||(($=j.current)==null?void 0:$.contains(w))||h()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[h]);const ee=i.useCallback((o,f)=>{const w=ne(o,f,"right",v,!0),O=se(o,f,w),K=re(w,o,f,v,O);A(w),k(K)},[v]),te=i.useCallback((o,f,w,O)=>{const K=w==="auto"?ne(o,f,"bottom"):w,$=O??se(o,f,K),Y=re(K,o,f,v,$);A(K),k(Y)},[v]);return i.useEffect(()=>{!I||!c||(s?ee(I,c):te(I,c,u,T))},[s,c,I,u,T,ee,te]),i.useEffect(()=>{y&&c&&ce(D)},[y,D,c]),n.jsxs(ie,{dropdownId:D,closeRoot:h,autoClose:g,children:[n.jsx("div",{ref:d,className:W.trigger,tabIndex:-1,onKeyDown:fe,onKeyUp:we,children:r}),P&&n.jsx(Ee,{children:n.jsx("div",{className:De(W.dropdown,e),"data-dropdown-id":D,"data-position":m,"data-open":U||void 0,...V,style:{...t,top:q.top,left:q.left},ref:H,onKeyUp:ve,onKeyDown:ye,children:n.jsx("ul",{className:W["dropdown-items"],role:"menu",children:L})})})]})});ue.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1}},composes:["CoreDropdownProps"]};const E={"dropdown-item":"_dropdown-item_nt3cr_29","dropdown-divider":"_dropdown-divider_nt3cr_66"},Ke=({label:r,link:e,leftIcon:t,trailingText:a,disabled:s,hasSeparator:u,hasIndent:g,children:y,badgeCount:_,badgeContent:L,badgeIcon:v,badgeType:T,showBadge:V,onClick:p,...D})=>{const{dropdownId:m,autoClose:A,closeRoot:R}=i.useContext(Z)||{},j=`${m}-${r&&r.replace(/\s+/g,"")}`,{isOpen:C,open:c}=le(j),M=()=>{m&&(l.closeSubMenus(m),c())},I=()=>{m&&l.closeSubMenus(m)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const N=d=>{s||(p&&p(d),A&&R&&R())},q=d=>{if([G,J].includes(d.key))if(e){const h=d.currentTarget.querySelector("a");h&&h.click()}else{if(s)return;p&&N(d),y&&c()}},k=d=>{d.preventDefault(),d.key===S&&(C&&ce(j),d.shiftKey&&m&&Ie(m))},{onKeyUp:P,onFocus:U,onKeyDown:H}=ae({onKeyUp:k,onFocus:I,onKeyDown:q},{interactiveKeyCodes:[G,J,S,F,Q,X]});return y?n.jsx(ue,{hasParent:!0,dropdownId:j,isOpen:C,trigger:n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:E["dropdown-item"],"data-active":C,"data-disabled":s,role:"menuitem",onMouseOver:M,onKeyUp:P,onKeyDown:H,onFocus:U,tabIndex:0,children:[g&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(B,{name:t,className:E["dropdown-item-icon"],appearance:C?"filled":"outlined"}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),n.jsx(B,{name:"arrow-chevron-right",className:E["dropdown-item-icon"]})]}),u&&n.jsx("div",{className:E["dropdown-divider"],children:n.jsx(oe,{})})]}),children:y}):n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:E["dropdown-item"],"data-disabled":s,role:"menuitem",onClick:N,onMouseOver:M,onKeyUp:P,onKeyDown:H,onFocus:U,tabIndex:0,...D,children:[g&&!t&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(B,{name:t,className:E["dropdown-item-icon"]}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),a&&n.jsx("div",{children:a}),ge({showBadge:!!V,badgeContent:L,badgeCount:_,badgeIcon:v})&&n.jsx(he,{count:_,content:L,icon:v,badgeType:T})]}),u&&n.jsx("div",{className:E["dropdown-divider"],children:n.jsx(oe,{})})]})};Ke.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{ue as D,Ke as a};

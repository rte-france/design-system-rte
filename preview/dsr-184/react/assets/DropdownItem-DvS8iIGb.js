import{j as n}from"./jsx-runtime-Cf8x2fCZ.js";import{T as S,S as $,E as F,e as T,c as U,b as V}from"./keyboard.constants-Cu8HPmfw.js";import{r as i}from"./index-G8LIXM5I.js";import{u as ee}from"./useActiveKeyboard-DMcHctAZ.js";import{D as G}from"./Divider-B0TD5a92.js";import{I as P}from"./Icon-DjEid3Hw.js";import{c as J,b as Q,a as X}from"./auto-placement-C6RxYMtA.js";import{u as fe}from"./useAnimatedMount-_zPBpYOt.js";import{O as we}from"./Overlay-Cz1UKDtP.js";import{c as ye}from"./index-DSdvzt-y.js";let b={};const E={};class l{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return b[e]||!1}static open(e){b[e]=!0,this.notifyListeners(e)}static close(e){delete b[e],this.notifyListeners(e)}static closeAll(){b={},Object.values(E).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(b)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(b).filter(a=>a.startsWith(e)&&a!==e).forEach(a=>l.close(a))}static subscribe(e,t){return E[e]||(E[e]=[]),E[e].push(t),()=>{E[e]=E[e].filter(r=>r!==t)}}static notifyListeners(e){var t;(t=E[e])==null||t.forEach(r=>r())}}const Y=i.createContext(void 0),te=({dropdownId:s,closeRoot:e,autoClose:t=!0,children:r})=>n.jsx(Y.Provider,{value:{dropdownId:s,closeRoot:e,autoClose:t},children:r});te.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const ve="_trigger_yp9yg_3",ge="_dropdown_yp9yg_15",H={trigger:ve,dropdown:ge,"dropdown-items":"_dropdown-items_yp9yg_41"},Z=s=>{var r;const e=oe(s),t=e.findIndex(a=>a===document.activeElement);t<e.length-1?e[t+1].focus():(r=e[0])==null||r.focus()},xe=s=>{var r;const e=oe(s),t=e.findIndex(a=>a===document.activeElement);t>0?e[t-1].focus():(r=e[e.length-1])==null||r.focus()},Ee=s=>{var t;const e=document.querySelector(`[data-dropdown-id='${s}']`);e&&((t=(e==null?void 0:e.querySelectorAll('li[role="menuitem"]'))[0])==null||t.focus())},he=s=>{var r;const e=l.getParentDropdownId(s),t=document.querySelector(`[data-dropdown-id='${e}']`);(r=t==null?void 0:t.querySelector("[data-active=true]"))==null||r.focus()},oe=s=>{const e=s==null?void 0:s.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},ne=s=>{const e=i.useRef(s||l.generateId()),[t,r]=i.useState(!1);i.useEffect(()=>l.subscribe(e.current,()=>{r(l.isOpen(e.current))}),[]);const a=()=>{l.open(e.current)},p=()=>{l.close(e.current)},v=()=>{t?p():a()};return{dropdownId:e.current,isOpen:t,open:a,close:p,toggle:v}},se=i.forwardRef(({trigger:s,className:e,style:t,dropdownId:r,hasParent:a,position:p="bottom",autoClose:v=!0,isOpen:w=!1,onClose:D=()=>{},children:q,offset:c=0,...k},y)=>{const{dropdownId:C}=ne(r),[R,j]=i.useState(p),{closeRoot:I}=i.useContext(Y)||{},K=i.useRef(null),O=i.useRef(null),[d,L]=i.useState(null),[g,u]=i.useState(null),[_,W]=i.useState({top:500,left:500}),{shouldRender:re,isAnimating:ae}=fe(w,150),ie=i.useCallback(o=>{O.current=o,L(o),typeof y=="function"?y(o):y&&(y.current=o)},[y]),ce=i.useCallback(o=>{K.current=o,u(o)},[]),A=i.useCallback(()=>{a&&I?I():D(),l.closeAll()},[I,a,D]),de=o=>{if(o.key===T||o.key===U){if(o.stopPropagation(),o.preventDefault(),d===null)return;o.key===T?Z(d):xe(d)}o.key===V&&A()},le=o=>{if(o.key===S){if(d===null)return;o.preventDefault(),Z(d)}},{onKeyDown:ue,onKeyUp:pe}=ee({onKeyUp:de},{interactiveKeyCodes:[$,F,S,T,U,V]});i.useEffect(()=>{const o=m=>{var N;const f=m.target,x=document.querySelectorAll("[data-dropdown-id]");Array.from(x).some(me=>me.contains(f))||((N=K.current)==null?void 0:N.contains(f))||A()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[A]);const B=i.useCallback((o,m)=>{const f=J(o,m,"right",c,!0),x=Q(o,m,f),M=X(f,o,m,c,x);j(f),W(M)},[c]),z=i.useCallback((o,m,f)=>{const x=f==="auto"?J(o,m,"bottom"):f,M=Q(o,m,x),N=X(x,o,m,c,M);j(x),W(N)},[c]);return i.useEffect(()=>{w&&(!g||!d||(a?B(g,d):z(g,d,p)))},[w,a,d,g,p,B,z]),n.jsxs(te,{dropdownId:C,closeRoot:A,autoClose:v,children:[n.jsx("div",{ref:ce,className:H.trigger,tabIndex:-1,onKeyDown:le,children:s}),re&&n.jsx(we,{children:n.jsx("div",{className:ye(H.dropdown,e),"data-dropdown-id":C,"data-position":R,"data-open":ae||void 0,...k,style:{...t,top:_.top,left:_.left},ref:ie,onKeyUp:pe,onKeyDown:ue,children:n.jsx("ul",{className:H["dropdown-items"],role:"menu",children:q})})})]})});se.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const h={"dropdown-item":"_dropdown-item_c1l0e_3","dropdown-divider":"_dropdown-divider_c1l0e_40"},De=({label:s,link:e,leftIcon:t,trailingText:r,disabled:a,hasSeparator:p,hasIndent:v,children:w,onClick:D,...q})=>{const{dropdownId:c,autoClose:k,closeRoot:y}=i.useContext(Y)||{},C=`${c}-${s&&s.replace(/\s+/g,"")}`,{isOpen:R,open:j}=ne(C),I=()=>{c&&(l.closeSubMenus(c),j())},K=()=>{c&&l.closeSubMenus(c)};v&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${s}' without indentation.`);const O=u=>{a||(D&&D(u),k&&y&&y())},d=u=>{if(u.preventDefault(),u.key===S&&(R&&Ee(C),u.shiftKey&&c&&he(c)),[$,F].includes(u.key))if(e){const _=u.currentTarget.querySelector("a");_&&_.click()}else{if(a)return;D&&O(u),w&&j()}},{onKeyUp:L,onFocus:g}=ee({onKeyUp:d,onFocus:K},{interactiveKeyCodes:[$,F,S,T,U,V]});return w?n.jsx(se,{hasParent:!0,dropdownId:C,isOpen:R,trigger:n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:h["dropdown-item"],"data-active":R,"data-disabled":a,role:"menuitem",onMouseOver:I,onKeyUp:L,onFocus:g,tabIndex:0,children:[v&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(P,{name:t,className:h["dropdown-item-icon"],appearance:R?"filled":"outlined"}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):n.jsx("span",{style:{flex:"2"},children:s}),n.jsx(P,{name:"arrow-chevron-right",className:h["dropdown-item-icon"]})]}),p&&n.jsx("div",{className:h["dropdown-divider"],children:n.jsx(G,{})})]}),children:w}):n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:h["dropdown-item"],"data-disabled":a,role:"menuitem",onClick:O,onMouseOver:I,onKeyUp:L,onFocus:g,tabIndex:0,...q,children:[v&&!t&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(P,{name:t,className:h["dropdown-item-icon"]}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):n.jsx("span",{style:{flex:"2"},children:s}),r&&n.jsx("div",{children:r})]}),p&&n.jsx("div",{className:h["dropdown-divider"],children:n.jsx(G,{})})]})};De.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{se as D,De as a};

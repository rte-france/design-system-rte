import{j as s}from"./jsx-runtime-Cf8x2fCZ.js";import{T as S,S as $,E as F,d as T,e as U,b as V}from"./keyboard.constants-KvjFtZ2v.js";import{r as i}from"./index-G8LIXM5I.js";import{u as te}from"./useActiveKeyboard-D-jDyZO1.js";import{D as J}from"./Divider-B0TD5a92.js";import{I as P}from"./Icon-DjEid3Hw.js";import{c as Q,b as X,a as Z,O as we}from"./Overlay-BSes1ir3.js";import{u as ye}from"./useAnimatedMount-_zPBpYOt.js";import{c as ve}from"./index-DSdvzt-y.js";let D={};const E={};class c{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return D[e]||!1}static open(e){D[e]=!0,this.notifyListeners(e)}static close(e){delete D[e],this.notifyListeners(e)}static closeAll(){D={},Object.values(E).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(D)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(D).filter(a=>a.startsWith(e)&&a!==e).forEach(a=>c.close(a))}static subscribe(e,t){return E[e]||(E[e]=[]),E[e].push(t),()=>{E[e]=E[e].filter(n=>n!==t)}}static notifyListeners(e){var t;(t=E[e])==null||t.forEach(n=>n())}}const Y=i.createContext(void 0),oe=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:n})=>s.jsx(Y.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:n});oe.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const ge="_trigger_yp9yg_3",Ee="_dropdown_yp9yg_15",H={trigger:ge,dropdown:Ee,"dropdown-items":"_dropdown-items_yp9yg_41"},ee=r=>{var n;const e=ne(r),t=e.findIndex(a=>a===document.activeElement);t<e.length-1?e[t+1].focus():(n=e[0])==null||n.focus()},xe=r=>{var n;const e=ne(r),t=e.findIndex(a=>a===document.activeElement);t>0?e[t-1].focus():(n=e[e.length-1])==null||n.focus()},he=r=>{var t;const e=document.querySelector(`[data-dropdown-id='${r}']`);e&&((t=(e==null?void 0:e.querySelectorAll('li[role="menuitem"]'))[0])==null||t.focus())},Ce=r=>{var n;const e=c.getParentDropdownId(r),t=document.querySelector(`[data-dropdown-id='${e}']`);(n=t==null?void 0:t.querySelector("[data-active=true]"))==null||n.focus()},ne=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},se=r=>{const e=i.useRef(r||c.generateId()),[t,n]=i.useState(!1);i.useEffect(()=>c.subscribe(e.current,()=>{n(c.isOpen(e.current))}),[]);const a=()=>{c.open(e.current)},l=()=>{c.close(e.current)},v=()=>{t?l():a()};return{dropdownId:e.current,isOpen:t,open:a,close:l,toggle:v}},re=i.forwardRef(({trigger:r,className:e,style:t,dropdownId:n,hasParent:a,position:l="bottom",autoClose:v=!0,isOpen:y=!1,onClose:_=()=>{},children:m,offset:g=0,alignment:R="start",...I},u)=>{const{dropdownId:b}=se(n),[K,O]=i.useState(l),{closeRoot:h}=i.useContext(Y)||{},L=i.useRef(null),A=i.useRef(null),[d,p]=i.useState(null),[M,ae]=i.useState(null),[W,B]=i.useState({top:500,left:500}),{shouldRender:ie,isAnimating:de}=ye(y,150),ce=i.useCallback(o=>{A.current=o,p(o),typeof u=="function"?u(o):u&&(u.current=o)},[u]),le=i.useCallback(o=>{L.current=o,ae(o)},[]),N=i.useCallback(()=>{a&&h?h():_(),c.closeAll()},[h,a,_]),ue=o=>{if(o.key===T||o.key===U){if(o.stopPropagation(),o.preventDefault(),d===null)return;o.key===T?ee(d):xe(d)}o.key===V&&N()},pe=o=>{if(o.key===S){if(d===null)return;o.preventDefault(),ee(d)}},{onKeyDown:me,onKeyUp:fe}=te({onKeyUp:ue},{interactiveKeyCodes:[$,F,S,T,U,V]});i.useEffect(()=>{const o=f=>{var k;const w=f.target,j=document.querySelectorAll("[data-dropdown-id]");Array.from(j).some(q=>q.contains(w))||((k=L.current)==null?void 0:k.contains(w))||N()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[N]);const z=i.useCallback((o,f)=>{const w=Q(o,f,"right",g,!0),j=X(o,f,w),C=Z(w,o,f,g,j);O(w),B(C)},[g]),G=i.useCallback((o,f,w,j)=>{const C=w==="auto"?Q(o,f,"bottom"):w,k=j??X(o,f,C),q=Z(C,o,f,g,k);O(C),B(q)},[g]);return i.useEffect(()=>{y&&(!M||!d||(a?z(M,d):G(M,d,l,R)))},[y,a,d,M,l,R,z,G]),s.jsxs(oe,{dropdownId:b,closeRoot:N,autoClose:v,children:[s.jsx("div",{ref:le,className:H.trigger,tabIndex:-1,onKeyDown:pe,children:r}),ie&&s.jsx(we,{children:s.jsx("div",{className:ve(H.dropdown,e),"data-dropdown-id":b,"data-position":K,"data-open":de||void 0,...I,style:{...t,top:W.top,left:W.left},ref:ce,onKeyUp:fe,onKeyDown:me,children:s.jsx("ul",{className:H["dropdown-items"],role:"menu",children:m})})})]})});re.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1}},composes:["CoreDropdownProps"]};const x={"dropdown-item":"_dropdown-item_c1l0e_3","dropdown-divider":"_dropdown-divider_c1l0e_40"},De=({label:r,leftIcon:e,trailingText:t,disabled:n,hasSeparator:a,hasIndent:l,children:v,onClick:y,..._})=>{const{dropdownId:m,autoClose:g,closeRoot:R}=i.useContext(Y)||{},I=`${m}-${r&&r.replace(/\s+/g,"")}`,{isOpen:u,open:b}=se(I),K=()=>{m&&(c.closeSubMenus(m),b())},O=()=>{m&&c.closeSubMenus(m)};l&&e&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${e}' for dropdownitem with label '${r}' without indentation.`);const h=p=>{n||(y&&y(p),g&&R&&R())},L=p=>{if(p.preventDefault(),p.key===S&&(u&&he(I),p.shiftKey&&m&&Ce(m)),p.key===F||p.key===$){if(n)return;y&&h(p),v&&b()}},{onKeyUp:A,onFocus:d}=te({onKeyUp:L,onFocus:O},{interactiveKeyCodes:[$,F,S,T,U,V]});return v?s.jsx(re,{hasParent:!0,dropdownId:I,isOpen:u,trigger:s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:x["dropdown-item"],"data-active":u,"data-disabled":n,role:"menuitem",onMouseOver:K,onKeyUp:A,onFocus:d,tabIndex:0,children:[l&&s.jsx("span",{style:{width:"20px"}}),e&&s.jsx(P,{name:e,className:x["dropdown-item-icon"],appearance:u?"filled":"outlined"}),s.jsx("span",{style:{flex:"2"},children:r}),s.jsx(P,{name:"arrow-chevron-right",className:x["dropdown-item-icon"]})]}),a&&s.jsx("div",{className:x["dropdown-divider"],children:s.jsx(J,{})})]}),children:v}):s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:x["dropdown-item"],"data-disabled":n,role:"menuitem",onClick:h,onMouseOver:K,onKeyUp:A,onFocus:d,tabIndex:0,..._,children:[l&&!e&&s.jsx("span",{style:{width:"20px"}}),e&&s.jsx(P,{name:e,className:x["dropdown-item-icon"]}),s.jsx("span",{style:{flex:"2"},children:r}),t&&s.jsx("div",{children:t})]}),a&&s.jsx("div",{className:x["dropdown-divider"],children:s.jsx(J,{})})]})};De.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{re as D,De as a};

import{j as s}from"./jsx-runtime-Cf8x2fCZ.js";import{T as _,S as $,E as F,c as S,d as V,b as Y}from"./keyboard.constants-ep-ZHn_7.js";import{r as i}from"./index-G8LIXM5I.js";import{u as te}from"./useActiveKeyboard-BPEscCvd.js";import{D as Q}from"./Divider-B0TD5a92.js";import{I as P}from"./Icon-DjEid3Hw.js";import{c as X,b as Z,a as ee,O as ge}from"./Overlay-BSes1ir3.js";import{u as Ee}from"./useAnimatedMount-_zPBpYOt.js";import{c as xe}from"./index-DSdvzt-y.js";let C={};const x={};class c{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return C[e]||!1}static open(e){C[e]=!0,this.notifyListeners(e)}static close(e){delete C[e],this.notifyListeners(e)}static closeAll(){C={},Object.values(x).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(C)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(C).filter(a=>a.startsWith(e)&&a!==e).forEach(a=>c.close(a))}static subscribe(e,t){return x[e]||(x[e]=[]),x[e].push(t),()=>{x[e]=x[e].filter(n=>n!==t)}}static notifyListeners(e){var t;(t=x[e])==null||t.forEach(n=>n())}}const W=i.createContext(void 0),oe=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:n})=>s.jsx(W.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:n});oe.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const he="_trigger_yp9yg_3",De="_dropdown_yp9yg_15",U={trigger:he,dropdown:De,"dropdown-items":"_dropdown-items_yp9yg_41"},H=r=>{var n;const e=se(r),t=e.findIndex(a=>a===document.activeElement);t<e.length-1?e[t+1].focus():(n=e[0])==null||n.focus()},Re=r=>{var n;const e=se(r),t=e.findIndex(a=>a===document.activeElement);t>0?e[t-1].focus():(n=e[e.length-1])==null||n.focus()},ne=r=>{var t;const e=document.querySelector(`[data-dropdown-id='${r}']`);e&&((t=(e==null?void 0:e.querySelectorAll('li[role="menuitem"]'))[0])==null||t.focus())},Ce=r=>{var n;const e=c.getParentDropdownId(r),t=document.querySelector(`[data-dropdown-id='${e}']`);(n=t==null?void 0:t.querySelector("[data-active=true]"))==null||n.focus()},se=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},re=r=>{const e=i.useRef(r||c.generateId()),[t,n]=i.useState(!1);i.useEffect(()=>c.subscribe(e.current,()=>{n(c.isOpen(e.current))}),[]);const a=()=>{c.open(e.current)},l=()=>{c.close(e.current)},v=()=>{t?l():a()};return{dropdownId:e.current,isOpen:t,open:a,close:l,toggle:v}},ae=i.forwardRef(({trigger:r,className:e,style:t,dropdownId:n,hasParent:a,position:l="bottom",autoClose:v=!0,isOpen:y=!1,onClose:K=()=>{},children:m,offset:g=0,alignment:I="start",...b},u)=>{const{dropdownId:E}=re(n),[O,L]=i.useState(l),{closeRoot:D}=i.useContext(W)||{},k=i.useRef(null),A=i.useRef(null),[d,p]=i.useState(null),[M,ie]=i.useState(null),[B,z]=i.useState({top:500,left:500}),{shouldRender:de,isAnimating:ce}=Ee(y,150),le=i.useCallback(o=>{A.current=o,p(o),typeof u=="function"?u(o):u&&(u.current=o)},[u]),ue=i.useCallback(o=>{k.current=o,ie(o)},[]),N=i.useCallback(()=>{a&&D?D():K(),c.closeAll()},[D,a,K]),pe=o=>{if(o.key===S||o.key===V){if(o.stopPropagation(),o.preventDefault(),d===null)return;o.key===S?H(d):Re(d)}},me=o=>{o.key===Y&&N()},fe=o=>{if(o.key===_){if(d===null)return;o.preventDefault(),H(d)}},we=o=>{if(o.key===_){if(d===null)return;o.preventDefault(),H(d)}},{onKeyDown:ye,onKeyUp:ve}=te({onKeyUp:me,onKeyDown:pe},{interactiveKeyCodes:[$,F,_,S,V,Y]});i.useEffect(()=>{const o=f=>{var T;const w=f.target,j=document.querySelectorAll("[data-dropdown-id]");Array.from(j).some(q=>q.contains(w))||((T=k.current)==null?void 0:T.contains(w))||N()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[N]);const G=i.useCallback((o,f)=>{const w=X(o,f,"right",g,!0),j=Z(o,f,w),R=ee(w,o,f,g,j);L(w),z(R)},[g]),J=i.useCallback((o,f,w,j)=>{const R=w==="auto"?X(o,f,"bottom"):w,T=j??Z(o,f,R),q=ee(R,o,f,g,T);L(R),z(q)},[g]);return i.useEffect(()=>{!M||!d||(a?G(M,d):J(M,d,l,I))},[a,d,M,l,I,G,J]),i.useEffect(()=>{y&&d&&ne(E)},[y,E,d]),s.jsxs(oe,{dropdownId:E,closeRoot:N,autoClose:v,children:[s.jsx("div",{ref:ue,className:U.trigger,tabIndex:-1,onKeyDown:fe,onKeyUp:we,children:r}),de&&s.jsx(ge,{children:s.jsx("div",{className:xe(U.dropdown,e),"data-dropdown-id":E,"data-position":O,"data-open":ce||void 0,...b,style:{...t,top:B.top,left:B.left},ref:le,onKeyUp:ve,onKeyDown:ye,children:s.jsx("ul",{className:U["dropdown-items"],role:"menu",children:m})})})]})});ae.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1}},composes:["CoreDropdownProps"]};const h={"dropdown-item":"_dropdown-item_c1l0e_3","dropdown-divider":"_dropdown-divider_c1l0e_40"},Ie=({label:r,leftIcon:e,trailingText:t,disabled:n,hasSeparator:a,hasIndent:l,children:v,onClick:y,...K})=>{const{dropdownId:m,autoClose:g,closeRoot:I}=i.useContext(W)||{},b=`${m}-${r&&r.replace(/\s+/g,"")}`,{isOpen:u,open:E}=re(b),O=()=>{m&&(c.closeSubMenus(m),E())},L=()=>{m&&c.closeSubMenus(m)};l&&e&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${e}' for dropdownitem with label '${r}' without indentation.`);const D=p=>{n||(y&&y(p),g&&I&&I())},k=p=>{if(p.preventDefault(),p.key===_&&(u&&ne(b),p.shiftKey&&m&&Ce(m)),p.key===F||p.key===$){if(n)return;y&&D(p),v&&E()}},{onKeyUp:A,onFocus:d}=te({onKeyUp:k,onFocus:L},{interactiveKeyCodes:[$,F,_,S,V,Y]});return v?s.jsx(ae,{hasParent:!0,dropdownId:b,isOpen:u,trigger:s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:h["dropdown-item"],"data-active":u,"data-disabled":n,role:"menuitem",onMouseOver:O,onKeyUp:A,onFocus:d,tabIndex:0,children:[l&&s.jsx("span",{style:{width:"20px"}}),e&&s.jsx(P,{name:e,className:h["dropdown-item-icon"],appearance:u?"filled":"outlined"}),s.jsx("span",{style:{flex:"2"},children:r}),s.jsx(P,{name:"arrow-chevron-right",className:h["dropdown-item-icon"]})]}),a&&s.jsx("div",{className:h["dropdown-divider"],children:s.jsx(Q,{})})]}),children:v}):s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:h["dropdown-item"],"data-disabled":n,role:"menuitem",onClick:D,onMouseOver:O,onKeyUp:A,onFocus:d,tabIndex:0,...K,children:[l&&!e&&s.jsx("span",{style:{width:"20px"}}),e&&s.jsx(P,{name:e,className:h["dropdown-item-icon"]}),s.jsx("span",{style:{flex:"2"},children:r}),t&&s.jsx("div",{children:t})]}),a&&s.jsx("div",{className:h["dropdown-divider"],children:s.jsx(Q,{})})]})};Ie.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{ae as D,Ie as a};

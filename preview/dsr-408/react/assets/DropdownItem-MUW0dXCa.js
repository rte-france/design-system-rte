import{j as n}from"./jsx-runtime-Cf8x2fCZ.js";import{T as _,S as F,E as V,c as S,d as Y,b as W}from"./keyboard.constants-ep-ZHn_7.js";import{r as i}from"./index-G8LIXM5I.js";import{u as oe}from"./useActiveKeyboard-BPEscCvd.js";import{D as X}from"./Divider-B0TD5a92.js";import{I as U}from"./Icon-DjEid3Hw.js";import{c as Z,b as ee,a as te,O as ge}from"./Overlay-xE_sH5Kz.js";import{u as xe}from"./useAnimatedMount-_zPBpYOt.js";import{c as Ee}from"./index-DSdvzt-y.js";let R={};const x={};class u{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return R[e]||!1}static open(e){R[e]=!0,this.notifyListeners(e)}static close(e){delete R[e],this.notifyListeners(e)}static closeAll(){R={},Object.values(x).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(R)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(R).filter(a=>a.startsWith(e)&&a!==e).forEach(a=>u.close(a))}static subscribe(e,t){return x[e]||(x[e]=[]),x[e].push(t),()=>{x[e]=x[e].filter(r=>r!==t)}}static notifyListeners(e){var t;(t=x[e])==null||t.forEach(r=>r())}}const B=i.createContext(void 0),ne=({dropdownId:s,closeRoot:e,autoClose:t=!0,children:r})=>n.jsx(B.Provider,{value:{dropdownId:s,closeRoot:e,autoClose:t},children:r});ne.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const he="_trigger_yp9yg_3",De="_dropdown_yp9yg_15",H={trigger:he,dropdown:De,"dropdown-items":"_dropdown-items_yp9yg_41"},$=s=>{var r;const e=re(s),t=e.findIndex(a=>a===document.activeElement);t<e.length-1?e[t+1].focus():(r=e[0])==null||r.focus()},Re=s=>{var r;const e=re(s),t=e.findIndex(a=>a===document.activeElement);t>0?e[t-1].focus():(r=e[e.length-1])==null||r.focus()},se=s=>{var t;const e=document.querySelector(`[data-dropdown-id='${s}']`);e&&((t=(e==null?void 0:e.querySelectorAll('li[role="menuitem"]'))[0])==null||t.focus())},Ce=s=>{var r;const e=u.getParentDropdownId(s),t=document.querySelector(`[data-dropdown-id='${e}']`);(r=t==null?void 0:t.querySelector("[data-active=true]"))==null||r.focus()},re=s=>{const e=s==null?void 0:s.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},ae=s=>{const e=i.useRef(s||u.generateId()),[t,r]=i.useState(!1);i.useEffect(()=>u.subscribe(e.current,()=>{r(u.isOpen(e.current))}),[]);const a=()=>{u.open(e.current)},p=()=>{u.close(e.current)},g=()=>{t?p():a()};return{dropdownId:e.current,isOpen:t,open:a,close:p,toggle:g}},ie=i.forwardRef(({trigger:s,className:e,style:t,dropdownId:r,hasParent:a,position:p="bottom",autoClose:g=!0,isOpen:v=!1,onClose:h=()=>{},children:q,offset:d=0,alignment:K="start",...O},m)=>{const{dropdownId:f}=ae(r),[L,C]=i.useState(p),{closeRoot:I}=i.useContext(B)||{},b=i.useRef(null),k=i.useRef(null),[c,T]=i.useState(null),[l,A]=i.useState(null),[z,G]=i.useState({top:500,left:500}),{shouldRender:ce,isAnimating:de}=xe(v,150),le=i.useCallback(o=>{k.current=o,T(o),typeof m=="function"?m(o):m&&(m.current=o)},[m]),ue=i.useCallback(o=>{b.current=o,A(o)},[]),M=i.useCallback(()=>{a&&I?I():h(),u.closeAll()},[I,a,h]),pe=o=>{if(o.key===S||o.key===Y){if(o.stopPropagation(),o.preventDefault(),c===null)return;o.key===S?$(c):Re(c)}},me=o=>{o.key===W&&M()},fe=o=>{if(o.key===_){if(c===null)return;o.preventDefault(),$(c)}},we=o=>{if(o.key===_){if(c===null)return;o.preventDefault(),$(c)}},{onKeyDown:ye,onKeyUp:ve}=oe({onKeyUp:me,onKeyDown:pe},{interactiveKeyCodes:[F,V,_,S,Y,W]});i.useEffect(()=>{const o=w=>{var N;const y=w.target,j=document.querySelectorAll("[data-dropdown-id]");Array.from(j).some(P=>P.contains(y))||((N=b.current)==null?void 0:N.contains(y))||M()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[M]);const J=i.useCallback((o,w)=>{const y=Z(o,w,"right",d,!0),j=ee(o,w,y),D=te(y,o,w,d,j);C(y),G(D)},[d]),Q=i.useCallback((o,w,y,j)=>{const D=y==="auto"?Z(o,w,"bottom"):y,N=j??ee(o,w,D),P=te(D,o,w,d,N);C(D),G(P)},[d]);return i.useEffect(()=>{!l||!c||(a?J(l,c):Q(l,c,p,K))},[a,c,l,p,K,J,Q]),i.useEffect(()=>{v&&c&&se(f)},[v,f,c]),n.jsxs(ne,{dropdownId:f,closeRoot:M,autoClose:g,children:[n.jsx("div",{ref:ue,className:H.trigger,tabIndex:-1,onKeyDown:fe,onKeyUp:we,children:s}),ce&&n.jsx(ge,{children:n.jsx("div",{className:Ee(H.dropdown,e),"data-dropdown-id":f,"data-position":L,"data-open":de||void 0,...O,style:{...t,top:z.top,left:z.left},ref:le,onKeyUp:ve,onKeyDown:ye,children:n.jsx("ul",{className:H["dropdown-items"],role:"menu",children:q})})})]})});ie.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1}},composes:["CoreDropdownProps"]};const E={"dropdown-item":"_dropdown-item_c1l0e_3","dropdown-divider":"_dropdown-divider_c1l0e_40"},Ie=({label:s,link:e,leftIcon:t,trailingText:r,disabled:a,hasSeparator:p,hasIndent:g,children:v,onClick:h,...q})=>{const{dropdownId:d,autoClose:K,closeRoot:O}=i.useContext(B)||{},m=`${d}-${s&&s.replace(/\s+/g,"")}`,{isOpen:f,open:L}=ae(m),C=()=>{d&&(u.closeSubMenus(d),L())},I=()=>{d&&u.closeSubMenus(d)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${s}' without indentation.`);const b=l=>{a||(h&&h(l),K&&O&&O())},k=l=>{if(l.preventDefault(),l.key===_&&(f&&se(m),l.shiftKey&&d&&Ce(d)),[F,V].includes(l.key))if(e){const A=l.currentTarget.querySelector("a");A&&A.click()}else{if(a)return;h&&b(l),v&&L()}},{onKeyUp:c,onFocus:T}=oe({onKeyUp:k,onFocus:I},{interactiveKeyCodes:[F,V,_,S,Y,W]});return v?n.jsx(ie,{hasParent:!0,dropdownId:m,isOpen:f,trigger:n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:E["dropdown-item"],"data-active":f,"data-disabled":a,role:"menuitem",onMouseOver:C,onKeyUp:c,onFocus:T,tabIndex:0,children:[g&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(U,{name:t,className:E["dropdown-item-icon"],appearance:f?"filled":"outlined"}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):n.jsx("span",{style:{flex:"2"},children:s}),n.jsx(U,{name:"arrow-chevron-right",className:E["dropdown-item-icon"]})]}),p&&n.jsx("div",{className:E["dropdown-divider"],children:n.jsx(X,{})})]}),children:v}):n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:E["dropdown-item"],"data-disabled":a,role:"menuitem",onClick:b,onMouseOver:C,onKeyUp:c,onFocus:T,tabIndex:0,...q,children:[g&&!t&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(U,{name:t,className:E["dropdown-item-icon"]}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):n.jsx("span",{style:{flex:"2"},children:s}),r&&n.jsx("div",{children:r})]}),p&&n.jsx("div",{className:E["dropdown-divider"],children:n.jsx(X,{})})]})};Ie.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{ie as D,Ie as a};

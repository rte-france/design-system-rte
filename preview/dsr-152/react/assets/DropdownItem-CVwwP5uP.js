import{j as s}from"./jsx-runtime-Cf8x2fCZ.js";import{T as N,S as W,E as B,c as P,d as z,b as G}from"./keyboard.constants-ep-ZHn_7.js";import{r as i}from"./index-G8LIXM5I.js";import{u as ne}from"./useActiveKeyboard-BPEscCvd.js";import{D as Z}from"./Divider-BPBlxbj_.js";import{I as F}from"./Icon-DjEid3Hw.js";import{c as ee,b as te,a as oe}from"./auto-placement-C6RxYMtA.js";import{u as ge}from"./useAnimatedMount-_zPBpYOt.js";import{O as xe}from"./Overlay-5j7SEEoz.js";import{c as he}from"./index-DSdvzt-y.js";const Ee=150;let b={};const E={};class l{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return b[e]||!1}static open(e){b[e]=!0,this.notifyListeners(e)}static close(e){delete b[e],this.notifyListeners(e)}static closeAll(){b={},Object.values(E).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(b)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(b).filter(n=>n.startsWith(e)&&n!==e).forEach(n=>l.close(n))}static subscribe(e,t){return E[e]||(E[e]=[]),E[e].push(t),()=>{E[e]=E[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=E[e])==null||t.forEach(a=>a())}}const J=i.createContext(void 0),se=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>s.jsx(J.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});se.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const De="_trigger_yp9yg_3",Ie="_dropdown_yp9yg_15",V={trigger:De,dropdown:Ie,"dropdown-items":"_dropdown-items_yp9yg_41"},Y=r=>{var a;const e=ae(r),t=e.findIndex(n=>n===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},Re=r=>{var a;const e=ae(r),t=e.findIndex(n=>n===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},re=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},Ce=r=>{var n;const e=l.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(n=a==null?void 0:a.querySelector("[data-active=true]"))==null||n.focus()},ae=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},ie=r=>{const e=i.useRef(r||l.generateId()),[t,a]=i.useState(!1);i.useEffect(()=>l.subscribe(e.current,()=>{a(l.isOpen(e.current))}),[]);const n=()=>{l.open(e.current)},p=()=>{l.close(e.current)},g=()=>{t?p():n()};return{dropdownId:e.current,isOpen:t,open:n,close:p,toggle:g}},ce=i.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:n,position:p="bottom",autoClose:g=!0,isOpen:w=!1,onClose:A=()=>{},children:j,offset:x=0,alignment:u="start",...U},y)=>{const{dropdownId:v}=ie(a),[I,K]=i.useState(p),{closeRoot:R}=i.useContext(J)||{},S=i.useRef(null),T=i.useRef(null),[c,H]=i.useState(null),[h,L]=i.useState(null),[_,d]=i.useState({top:500,left:500}),{shouldRender:M,isAnimating:de}=ge(w,Ee),le=i.useCallback(o=>{T.current=o,H(o),typeof y=="function"?y(o):y&&(y.current=o)},[y]),ue=i.useCallback(o=>{S.current=o,L(o)},[]),q=i.useCallback(()=>{n&&R?R():A(),l.closeAll()},[R,n,A]),pe=o=>{if(o.key===P||o.key===z){if(o.stopPropagation(),o.preventDefault(),c===null)return;o.key===P?Y(c):Re(c)}},me=o=>{o.key===G&&q()},fe=o=>{if(o.key===N){if(c===null)return;o.preventDefault(),Y(c)}},we=o=>{if(o.key===N){if(c===null)return;o.preventDefault(),Y(c)}},{onKeyDown:ye,onKeyUp:ve}=ne({onKeyUp:me,onKeyDown:pe},{interactiveKeyCodes:[W,B,N,P,z,G]});i.useEffect(()=>{const o=m=>{var k;const f=m.target,O=document.querySelectorAll("[data-dropdown-id]");Array.from(O).some($=>$.contains(f))||((k=S.current)==null?void 0:k.contains(f))||q()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[q]);const Q=i.useCallback((o,m)=>{const f=ee(o,m,"right",x,!0),O=te(o,m,f),C=oe(f,o,m,x,O);K(f),d(C)},[x]),X=i.useCallback((o,m,f,O)=>{const C=f==="auto"?ee(o,m,"bottom"):f,k=O??te(o,m,C),$=oe(C,o,m,x,k);K(C),d($)},[x]);return i.useEffect(()=>{!h||!c||(n?Q(h,c):X(h,c,p,u))},[n,c,h,p,u,Q,X]),i.useEffect(()=>{w&&c&&re(v)},[w,v,c]),s.jsxs(se,{dropdownId:v,closeRoot:q,autoClose:g,children:[s.jsx("div",{ref:ue,className:V.trigger,tabIndex:-1,onKeyDown:fe,onKeyUp:we,children:r}),M&&s.jsx(xe,{children:s.jsx("div",{className:he(V.dropdown,e),"data-dropdown-id":v,"data-position":I,"data-open":de||void 0,...U,style:{...t,top:_.top,left:_.left},ref:le,onKeyUp:ve,onKeyDown:ye,children:s.jsx("ul",{className:V["dropdown-items"],role:"menu",children:j})})})]})});ce.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1}},composes:["CoreDropdownProps"]};const D={"dropdown-item":"_dropdown-item_c1l0e_3","dropdown-divider":"_dropdown-divider_c1l0e_40"},be=({label:r,link:e,leftIcon:t,trailingText:a,disabled:n,hasSeparator:p,hasIndent:g,children:w,isSelected:A,onClick:j,...x})=>{const{dropdownId:u,autoClose:U,closeRoot:y}=i.useContext(J)||{},v=`${u}-${r&&r.replace(/\s+/g,"")}`,{isOpen:I,open:K}=ie(v),R=()=>{u&&(l.closeSubMenus(u),K())},S=()=>{u&&l.closeSubMenus(u)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const T=d=>{n||(j&&j(d),U&&y&&y())},c=d=>{if([W,B].includes(d.key))if(e){const M=d.currentTarget.querySelector("a");M&&M.click()}else{if(n)return;j&&T(d),w&&K()}},H=d=>{d.preventDefault(),d.key===N&&(I&&re(v),d.shiftKey&&u&&Ce(u))},{onKeyUp:h,onFocus:L,onKeyDown:_}=ne({onKeyUp:H,onFocus:S,onKeyDown:c},{interactiveKeyCodes:[W,B,N,P,z,G]});return w?s.jsx(ce,{hasParent:!0,dropdownId:v,isOpen:I,trigger:s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:D["dropdown-item"],"data-active":I,"data-disabled":n,role:"menuitem",onMouseOver:R,onKeyUp:h,onKeyDown:_,onFocus:L,tabIndex:0,children:[g&&s.jsx("span",{style:{width:"20px"}}),t&&s.jsx(F,{name:t,className:D["dropdown-item-icon"],appearance:I?"filled":"outlined"}),e?s.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):s.jsx("span",{style:{flex:"2"},children:r}),s.jsx(F,{name:"arrow-chevron-right",className:D["dropdown-item-icon"]})]}),p&&s.jsx("div",{className:D["dropdown-divider"],children:s.jsx(Z,{})})]}),children:w}):s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:D["dropdown-item"],"data-disabled":n,"data-active":A,role:"menuitem",onClick:T,onMouseOver:R,onKeyUp:h,onKeyDown:_,onFocus:L,tabIndex:0,...x,children:[g&&!t&&s.jsx("span",{style:{width:"20px"}}),t&&s.jsx(F,{name:t,className:D["dropdown-item-icon"]}),e?s.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):s.jsx("span",{style:{flex:"2"},children:r}),a&&s.jsx("div",{children:a})]}),p&&s.jsx("div",{className:D["dropdown-divider"],children:s.jsx(Z,{})})]})};be.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{ce as D,be as a};

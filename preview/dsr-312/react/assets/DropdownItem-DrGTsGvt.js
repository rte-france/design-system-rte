import{j as o}from"./jsx-runtime-Cf8x2fCZ.js";import{s as Ee,B as De}from"./Badge-CQk6fGHb.js";import{T as Y,E as Z,b as B,d as ee,c as te,S as re}from"./keyboard.constants-BverKK8B.js";import{r as d}from"./index-G8LIXM5I.js";import{u as le}from"./useActiveKeyboard-DaOmFJe_.js";import{D as W}from"./Divider-cNGLKJiC.js";import{I as X}from"./Icon-DjEid3Hw.js";import{c as ae,b as de,a as ce}from"./auto-placement-C6RxYMtA.js";import{a as Re}from"./dom.constants-41SiyeDe.js";import{u as _e}from"./useAnimatedMount-_zPBpYOt.js";import{O as Ie}from"./Overlay-BI5SO8Nq.js";import{c as $}from"./index-DSdvzt-y.js";const je=150;let j={};const R={};class f{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return j[e]||!1}static open(e){j[e]=!0,this.notifyListeners(e)}static close(e){delete j[e],this.notifyListeners(e)}static closeAll(){j={},Object.values(R).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(j)}static getParentDropdownId(e){const t=e.split("-");return t.length<2?null:(t.pop(),t.join("-"))}static closeSubMenus(e,t){Object.keys(j).filter(c=>c.startsWith(e)&&c!==e&&c!==t).forEach(c=>f.close(c))}static subscribe(e,t){return R[e]||(R[e]=[]),R[e].push(t),()=>{R[e]=R[e].filter(r=>r!==t)}}static notifyListeners(e){var t;(t=R[e])==null||t.forEach(r=>r())}}const oe=d.createContext(void 0),ue=({dropdownId:s,closeRoot:e,autoClose:t=!0,children:r})=>o.jsx(oe.Provider,{value:{dropdownId:s,closeRoot:e,autoClose:t},children:r});ue.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Ce="_trigger_19dwi_1",Ne="_dropdown_19dwi_13",C={trigger:Ce,dropdown:Ne,"dropdown-menu-header":"_dropdown-menu-header_19dwi_39","dropdown-menu-content":"_dropdown-menu-content_19dwi_39","dropdown-menu-footer":"_dropdown-menu-footer_19dwi_39","dropdown-items":"_dropdown-items_19dwi_42"},ie=s=>{var r;const e=me(s),t=e.findIndex(a=>a===document.activeElement);t<e.length-1?e[t+1].focus():(r=e[0])==null||r.focus()},be=s=>{var r;const e=me(s),t=e.findIndex(a=>a===document.activeElement);t>0?e[t-1].focus():(r=e[e.length-1])==null||r.focus()},pe=s=>{var r;const e=s?CSS.escape(s):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((r=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||r.focus())},Oe=s=>{var a;const e=f.getParentDropdownId(s),t=e?CSS.escape(e):null;if(!t)return;const r=document.querySelector(`[data-dropdown-id='${t}']`);(a=r==null?void 0:r.querySelector("[data-active=true]"))==null||a.focus()},me=s=>{const e=s==null?void 0:s.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},fe=s=>{const e=d.useRef(s||f.generateId()),[t,r]=d.useState(!1);d.useEffect(()=>f.subscribe(e.current,()=>{r(f.isOpen(e.current))}),[]);const a=()=>{f.open(e.current)},c=()=>{f.close(e.current)},g=()=>{t?c():a()};return{dropdownId:e.current,isOpen:t,open:a,close:c,toggle:g}},we=d.forwardRef(({trigger:s,className:e,style:t,dropdownId:r,hasParent:a,position:c="bottom",autoClose:g=!0,isOpen:y=!1,onClose:N=()=>{},children:T,offset:v=0,alignment:S="start",autofocus:A=!0,header:q,footer:L,...b},x)=>{const{dropdownId:l}=fe(r),[z,O]=d.useState(c),{closeRoot:E}=d.useContext(oe)||{},w=d.useRef(null),M=d.useRef(null),[i,Q]=d.useState(null),[D,G]=d.useState(null),[P,K]=d.useState({top:500,left:500}),{shouldRender:k,isAnimating:U}=_e(y,je),m=d.useCallback(n=>{M.current=n,Q(n),typeof x=="function"?x(n):x&&(x.current=n)},[x]),F=d.useCallback(n=>{w.current=n,G(n)},[]),H=d.useCallback(()=>{a&&E?E():N(),f.closeAll()},[E,a,N]),ye=n=>{if(n.key===B||n.key===ee){if(n.stopPropagation(),n.preventDefault(),i===null)return;n.key===B?ie(i):be(i)}},ve=n=>{var u,p;if(n.key===te){H();const h=(u=w.current)==null?void 0:u.querySelectorAll(Re)[0];h?h.focus():(p=w.current)==null||p.focus()}},he=n=>{if(n.key===Y){if(i===null)return;n.preventDefault(),ie(i)}},{onKeyDown:ge,onKeyUp:xe}=le({onKeyUp:ve,onKeyDown:ye},{interactiveKeyCodes:[Z,Y,B,ee,te]});d.useEffect(()=>{const n=u=>{var V;const p=u.target,h=document.querySelectorAll("[data-dropdown-id]");Array.from(h).some(J=>J.contains(p))||((V=w.current)==null?void 0:V.contains(p))||H()};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[H]);const ne=d.useCallback((n,u)=>{const p=ae(n,u,"right",v,!0),h=de(n,u,p),I=ce(p,n,u,v,h);O(p),K(I)},[v]),se=d.useCallback((n,u,p,h)=>{const I=p==="auto"?ae(n,u,"bottom"):p,V=h??de(n,u,I),J=ce(I,n,u,v,V);O(I),K(J)},[v]);return d.useEffect(()=>{!D||!i||(a?ne(D,i):se(D,i,c,S))},[a,i,D,c,S,ne,se]),d.useEffect(()=>{y&&i&&A&&pe(l)},[y,l,i,A]),o.jsxs(ue,{dropdownId:l,closeRoot:H,autoClose:g,children:[o.jsx("div",{ref:F,className:C.trigger,tabIndex:-1,onKeyDown:he,children:s}),k&&o.jsx(Ie,{children:o.jsxs("div",{className:$(C.dropdown,e),"data-dropdown-id":l,"data-position":z,"data-open":U||void 0,...b,style:{...t,top:P.top,left:P.left},ref:m,onKeyUp:xe,onKeyDown:ge,children:[q&&o.jsxs("div",{className:$(C["dropdown-menu-header"],"rte-dropdown-menu-header"),children:[q,o.jsx(W,{})]}),o.jsx("div",{className:$(C["dropdown-menu-content"],"rte-dropdown-menu-content"),children:o.jsx("ul",{className:C["dropdown-items"],role:"menu",children:T})}),L&&o.jsxs("div",{className:$(C["dropdown-menu-footer"],"rte-dropdown-menu-footer"),children:[o.jsx(W,{}),L]})]})})]})});we.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},header:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},footer:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const _={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},Ke=({label:s,link:e,leftIcon:t,trailingText:r,disabled:a,hasSeparator:c,hasIndent:g,children:y,badgeCount:N,badgeContent:T,badgeIcon:v,badgeType:S,badgeSize:A,showBadge:q,isSelected:L,onClick:b,...x})=>{const{dropdownId:l,autoClose:z,closeRoot:O}=d.useContext(oe)||{},E=`${l}-${s&&s.replace(/\s+/g,"")}`,{isOpen:w,open:M}=fe(E),i=()=>{l&&(f.closeSubMenus(l),M())},Q=()=>{l&&f.closeSubMenus(l)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${s}' without indentation.`);const D=m=>{a||(b&&b(m),z&&O&&O())},G=m=>{if([re,Z].includes(m.key))if(e){const F=m.currentTarget.querySelector("a");F&&F.click()}else{if(a)return;b&&D(m),y&&M()}},P=m=>{m.preventDefault(),m.key===Y&&(w&&pe(E),m.shiftKey&&l&&Oe(l))},{onKeyUp:K,onFocus:k,onKeyDown:U}=le({onKeyUp:P,onFocus:Q,onKeyDown:G},{interactiveKeyCodes:[re,Z,Y,B,ee,te]});return y?o.jsx(we,{hasParent:!0,dropdownId:E,isOpen:w,trigger:o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:_["dropdown-item"],"data-active":w,"data-disabled":a,role:"menuitem",onMouseOver:i,onKeyUp:K,onKeyDown:U,onFocus:k,tabIndex:0,children:[g&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(X,{name:t,className:_["dropdown-item-icon"],appearance:w?"filled":"outlined"}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):o.jsx("span",{style:{flex:"2"},children:s}),o.jsx(X,{name:"arrow-chevron-right",className:_["dropdown-item-icon"]})]}),c&&o.jsx("div",{className:_["dropdown-divider"],children:o.jsx(W,{})})]}),children:y}):o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:_["dropdown-item"],"data-disabled":a,"data-active":L,role:"menuitem",onClick:D,onMouseOver:i,onKeyUp:K,onKeyDown:U,onFocus:k,tabIndex:0,...x,children:[g&&!t&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(X,{name:t,className:_["dropdown-item-icon"]}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):o.jsx("span",{style:{flex:"2"},children:s}),r&&o.jsx("div",{children:r}),Ee({showBadge:!!q,badgeContent:T,badgeCount:N,badgeIcon:v})&&o.jsx(De,{count:N,content:T,icon:v,badgeType:S,size:A})]}),c&&o.jsx("div",{className:_["dropdown-divider"],children:o.jsx(W,{})})]})};Ke.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{we as D,Ke as a};

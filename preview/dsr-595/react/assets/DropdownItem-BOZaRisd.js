import{j as o}from"./jsx-runtime-Cf8x2fCZ.js";import{s as Ee,B as De}from"./Badge-b6ITl72-.js";import{T as Y,E as te,b as B,d as oe,c as ne,S as de}from"./keyboard.constants-BverKK8B.js";import{r as d}from"./index-G8LIXM5I.js";import{u as pe}from"./useActiveKeyboard-DaOmFJe_.js";import{C as Re}from"./Checkbox-COL5NWrm.js";import{D as W}from"./Divider-cNGLKJiC.js";import{I as ee}from"./Icon-DjEid3Hw.js";import{c as ce,b as ie,a as le}from"./auto-placement-C6RxYMtA.js";import{a as _e}from"./dom.constants-41SiyeDe.js";import{u as je}from"./useAnimatedMount-_zPBpYOt.js";import{O as Ce}from"./Overlay-CQ0GhNxd.js";import{c as $}from"./index-DSdvzt-y.js";const Ie=150;let I={};const R={};class f{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return I[e]||!1}static open(e){I[e]=!0,this.notifyListeners(e)}static close(e){delete I[e],this.notifyListeners(e)}static closeAll(){I={},Object.values(R).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(I)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(I).filter(r=>r.startsWith(e)&&r!==e).forEach(r=>f.close(r))}static subscribe(e,t){return R[e]||(R[e]=[]),R[e].push(t),()=>{R[e]=R[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=R[e])==null||t.forEach(a=>a())}}const se=d.createContext(void 0),me=({dropdownId:s,closeRoot:e,autoClose:t=!0,children:a})=>o.jsx(se.Provider,{value:{dropdownId:s,closeRoot:e,autoClose:t},children:a});me.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Ne="_trigger_19dwi_1",Oe="_dropdown_19dwi_13",N={trigger:Ne,dropdown:Oe,"dropdown-menu-header":"_dropdown-menu-header_19dwi_39","dropdown-menu-content":"_dropdown-menu-content_19dwi_39","dropdown-menu-footer":"_dropdown-menu-footer_19dwi_39","dropdown-items":"_dropdown-items_19dwi_42"},ue=s=>{var a;const e=we(s),t=e.findIndex(r=>r===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},be=s=>{var a;const e=we(s),t=e.findIndex(r=>r===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},fe=s=>{var a;const e=s?CSS.escape(s):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},Ke=s=>{var r;const e=f.getParentDropdownId(s),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(r=a==null?void 0:a.querySelector("[data-active=true]"))==null||r.focus()},we=s=>{const e=s==null?void 0:s.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},ye=s=>{const e=d.useRef(s||f.generateId()),[t,a]=d.useState(!1);d.useEffect(()=>f.subscribe(e.current,()=>{a(f.isOpen(e.current))}),[]);const r=()=>{f.open(e.current)},w=()=>{f.close(e.current)},g=()=>{t?w():r()};return{dropdownId:e.current,isOpen:t,open:r,close:w,toggle:g}},he=d.forwardRef(({trigger:s,className:e,style:t,dropdownId:a,hasParent:r,position:w="bottom",autoClose:g=!0,isOpen:y=!1,onClose:O=()=>{},children:S,offset:h=0,alignment:L="start",autofocus:q=!0,header:M,footer:b,...z},p)=>{const{dropdownId:j}=ye(a),[Q,m]=d.useState(w),{closeRoot:K}=d.useContext(se)||{},x=d.useRef(null),T=d.useRef(null),[c,P]=d.useState(null),[E,G]=d.useState(null),[A,k]=d.useState({top:500,left:500}),{shouldRender:J,isAnimating:X}=je(y,Ie),U=d.useCallback(n=>{T.current=n,P(n),typeof p=="function"?p(n):p&&(p.current=n)},[p]),F=d.useCallback(n=>{x.current=n,G(n)},[]),D=d.useCallback(()=>{r&&K?K():O(),f.closeAll()},[K,r,O]),i=n=>{if(n.key===B||n.key===oe){if(n.stopPropagation(),n.preventDefault(),c===null)return;n.key===B?ue(c):be(c)}},H=n=>{var l,u;if(n.key===ne){D();const v=(l=x.current)==null?void 0:l.querySelectorAll(_e)[0];v?v.focus():(u=x.current)==null||u.focus()}},ve=n=>{if(n.key===Y){if(c===null)return;n.preventDefault(),ue(c)}},{onKeyDown:ge,onKeyUp:xe}=pe({onKeyUp:H,onKeyDown:i},{interactiveKeyCodes:[te,Y,B,oe,ne]});d.useEffect(()=>{const n=l=>{var V;const u=l.target,v=document.querySelectorAll("[data-dropdown-id]");Array.from(v).some(Z=>Z.contains(u))||((V=x.current)==null?void 0:V.contains(u))||D()};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[D]);const re=d.useCallback((n,l)=>{const u=ce(n,l,"right",h,!0),v=ie(n,l,u),C=le(u,n,l,h,v);m(u),k(C)},[h]),ae=d.useCallback((n,l,u,v)=>{const C=u==="auto"?ce(n,l,"bottom"):u,V=v??ie(n,l,C),Z=le(C,n,l,h,V);m(C),k(Z)},[h]);return d.useEffect(()=>{!E||!c||(r?re(E,c):ae(E,c,w,L))},[r,c,E,w,L,re,ae]),d.useEffect(()=>{y&&c&&q&&fe(j)},[y,j,c,q]),o.jsxs(me,{dropdownId:j,closeRoot:D,autoClose:g,children:[o.jsx("div",{ref:F,className:N.trigger,tabIndex:-1,onKeyDown:ve,children:s}),J&&o.jsx(Ce,{children:o.jsxs("div",{className:$(N.dropdown,e),"data-dropdown-id":j,"data-position":Q,"data-open":X||void 0,...z,style:{...t,top:A.top,left:A.left},ref:U,onKeyUp:xe,onKeyDown:ge,children:[M&&o.jsxs("div",{className:$(N["dropdown-menu-header"],"rte-dropdown-menu-header"),children:[M,o.jsx(W,{})]}),o.jsx("div",{className:$(N["dropdown-menu-content"],"rte-dropdown-menu-content"),children:o.jsx("ul",{className:N["dropdown-items"],role:"menu",children:S})}),b&&o.jsxs("div",{className:$(N["dropdown-menu-footer"],"rte-dropdown-menu-footer"),children:[o.jsx(W,{}),b]})]})})]})});he.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},header:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},footer:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const _={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},Te=({label:s,link:e,leftIcon:t,trailingText:a,disabled:r,hasSeparator:w,hasIndent:g,children:y,badgeCount:O,badgeContent:S,badgeIcon:h,badgeType:L,badgeSize:q,showBadge:M,isSelected:b,isIndeterminate:z,onClick:p,hasCheckbox:j,...Q})=>{const{dropdownId:m,autoClose:K,closeRoot:x}=d.useContext(se)||{},T=`${m}-${s&&s.replace(/\s+/g,"")}`,{isOpen:c,open:P}=ye(T),E=()=>{m&&(f.closeSubMenus(m),P())},G=()=>{m&&f.closeSubMenus(m)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${s}' without indentation.`);const A=i=>{r||(p&&p(i),K&&x&&x())},k=i=>{i.stopPropagation(),!r&&p&&p(i)},J=i=>{if([de,te].includes(i.key))if(e){const H=i.currentTarget.querySelector("a");H&&H.click()}else{if(r)return;p&&A(i),y&&P()}},X=i=>{i.preventDefault(),i.key===Y&&(c&&fe(T),i.shiftKey&&m&&Ke(m))},{onKeyUp:U,onFocus:F,onKeyDown:D}=pe({onKeyUp:X,onFocus:G,onKeyDown:J},{interactiveKeyCodes:[de,te,Y,B,oe,ne]});return y?o.jsx(he,{hasParent:!0,dropdownId:T,isOpen:c,trigger:o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:_["dropdown-item"],"data-active":c,"data-disabled":r,role:"menuitem",onMouseOver:E,onKeyUp:U,onKeyDown:D,onFocus:F,tabIndex:0,children:[g&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(ee,{name:t,className:_["dropdown-item-icon"],appearance:c?"filled":"outlined"}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):o.jsx("span",{style:{flex:"2"},children:s}),o.jsx(ee,{name:"arrow-chevron-right",className:_["dropdown-item-icon"]})]}),w&&o.jsx("div",{className:_["dropdown-divider"],children:o.jsx(W,{})})]}),children:y}):o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:_["dropdown-item"],"data-disabled":r,"data-active":b,role:"menuitem",onClick:A,onMouseOver:E,onKeyUp:U,onKeyDown:D,onFocus:F,tabIndex:0,...Q,children:[j&&o.jsx(Re,{id:m+":"+s,label:s||"",checked:b,showLabel:!1,indeterminate:z,onChange:k}),g&&!t&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(ee,{name:t,className:_["dropdown-item-icon"]}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):o.jsx("span",{style:{flex:"2"},children:s}),a&&o.jsx("div",{children:a}),Ee({showBadge:!!M,badgeContent:S,badgeCount:O,badgeIcon:h})&&o.jsx(De,{count:O,content:S,icon:h,badgeType:L,size:q})]}),w&&o.jsx("div",{className:_["dropdown-divider"],children:o.jsx(W,{})})]})};Te.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{he as D,Te as a};

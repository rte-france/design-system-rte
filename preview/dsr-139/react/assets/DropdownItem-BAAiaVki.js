import{j as s}from"./jsx-runtime-Cf8x2fCZ.js";import{T as O,S as Y,E as W,b as k,d as z,c as B}from"./keyboard.constants-BverKK8B.js";import{r as i}from"./index-G8LIXM5I.js";import{u as ne}from"./useActiveKeyboard-DaOmFJe_.js";import{D as Z}from"./Divider-BPBlxbj_.js";import{I as V}from"./Icon-DjEid3Hw.js";import{c as ee,b as te,a as oe}from"./auto-placement-C6RxYMtA.js";import{u as xe}from"./useAnimatedMount-_zPBpYOt.js";import{O as he}from"./Overlay-CwMsU-JP.js";import{c as Ee}from"./index-DSdvzt-y.js";let R={};const h={};class u{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return R[e]||!1}static open(e){R[e]=!0,this.notifyListeners(e)}static close(e){delete R[e],this.notifyListeners(e)}static closeAll(){R={},Object.values(h).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(R)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(R).filter(n=>n.startsWith(e)&&n!==e).forEach(n=>u.close(n))}static subscribe(e,t){return h[e]||(h[e]=[]),h[e].push(t),()=>{h[e]=h[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=h[e])==null||t.forEach(a=>a())}}const G=i.createContext(void 0),se=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>s.jsx(G.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});se.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const De="_trigger_12gzf_3",Ce="_dropdown_12gzf_15",$={trigger:De,dropdown:Ce,"dropdown-items":"_dropdown-items_12gzf_41"},F=r=>{var a;const e=ae(r),t=e.findIndex(n=>n===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},Ie=r=>{var a;const e=ae(r),t=e.findIndex(n=>n===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},re=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},Re=r=>{var n;const e=u.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(n=a==null?void 0:a.querySelector("[data-active=true]"))==null||n.focus()},ae=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},ie=r=>{const e=i.useRef(r||u.generateId()),[t,a]=i.useState(!1);i.useEffect(()=>u.subscribe(e.current,()=>{a(u.isOpen(e.current))}),[]);const n=()=>{u.open(e.current)},m=()=>{u.close(e.current)},v=()=>{t?m():n()};return{dropdownId:e.current,isOpen:t,open:n,close:m,toggle:v}},ce=i.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:n,position:m="bottom",autoClose:v=!0,isOpen:y=!1,onClose:D=()=>{},children:P,offset:d=0,alignment:S="start",autofocus:b=!0,...j},p)=>{const{dropdownId:g}=ie(a),[L,T]=i.useState(m),{closeRoot:C}=i.useContext(G)||{},A=i.useRef(null),U=i.useRef(null),[c,M]=i.useState(null),[x,l]=i.useState(null),[K,J]=i.useState({top:500,left:500}),{shouldRender:de,isAnimating:le}=xe(y,150),ue=i.useCallback(o=>{U.current=o,M(o),typeof p=="function"?p(o):p&&(p.current=o)},[p]),pe=i.useCallback(o=>{A.current=o,l(o)},[]),N=i.useCallback(()=>{n&&C?C():D(),u.closeAll()},[C,n,D]),me=o=>{if(o.key===k||o.key===z){if(o.stopPropagation(),o.preventDefault(),c===null)return;o.key===k?F(c):Ie(c)}},fe=o=>{o.key===B&&N()},we=o=>{if(o.key===O){if(c===null)return;o.preventDefault(),F(c)}},ye=o=>{if(o.key===O){if(c===null)return;o.preventDefault(),F(c)}},{onKeyDown:ve,onKeyUp:ge}=ne({onKeyUp:fe,onKeyDown:me},{interactiveKeyCodes:[Y,W,O,k,z,B]});i.useEffect(()=>{const o=f=>{var q;const w=f.target,_=document.querySelectorAll("[data-dropdown-id]");Array.from(_).some(H=>H.contains(w))||((q=A.current)==null?void 0:q.contains(w))||N()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[N]);const Q=i.useCallback((o,f)=>{const w=ee(o,f,"right",d,!0),_=te(o,f,w),I=oe(w,o,f,d,_);T(w),J(I)},[d]),X=i.useCallback((o,f,w,_)=>{const I=w==="auto"?ee(o,f,"bottom"):w,q=_??te(o,f,I),H=oe(I,o,f,d,q);T(I),J(H)},[d]);return i.useEffect(()=>{!x||!c||(n?Q(x,c):X(x,c,m,S))},[n,c,x,m,S,Q,X]),i.useEffect(()=>{y&&c&&b&&re(g)},[y,g,c,b]),s.jsxs(se,{dropdownId:g,closeRoot:N,autoClose:v,children:[s.jsx("div",{ref:pe,className:$.trigger,tabIndex:-1,onKeyDown:we,onKeyUp:ye,children:r}),de&&s.jsx(he,{children:s.jsx("div",{className:Ee($.dropdown,e),"data-dropdown-id":g,"data-position":L,"data-open":le||void 0,...j,style:{...t,top:K.top,left:K.left},ref:ue,onKeyUp:ge,onKeyDown:ve,children:s.jsx("ul",{className:$["dropdown-items"],role:"menu",children:P})})})]})});ce.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const E={"dropdown-item":"_dropdown-item_c1l0e_3","dropdown-divider":"_dropdown-divider_c1l0e_40"},be=({label:r,link:e,leftIcon:t,trailingText:a,disabled:n,hasSeparator:m,hasIndent:v,children:y,onClick:D,...P})=>{const{dropdownId:d,autoClose:S,closeRoot:b}=i.useContext(G)||{},j=`${d}-${r&&r.replace(/\s+/g,"")}`,{isOpen:p,open:g}=ie(j),L=()=>{d&&(u.closeSubMenus(d),g())},T=()=>{d&&u.closeSubMenus(d)};v&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const C=l=>{n||(D&&D(l),S&&b&&b())},A=l=>{if([Y,W].includes(l.key))if(e){const K=l.currentTarget.querySelector("a");K&&K.click()}else{if(n)return;D&&C(l),y&&g()}},U=l=>{l.preventDefault(),l.key===O&&(p&&re(j),l.shiftKey&&d&&Re(d))},{onKeyUp:c,onFocus:M,onKeyDown:x}=ne({onKeyUp:U,onFocus:T,onKeyDown:A},{interactiveKeyCodes:[Y,W,O,k,z,B]});return y?s.jsx(ce,{hasParent:!0,dropdownId:j,isOpen:p,trigger:s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:E["dropdown-item"],"data-active":p,"data-disabled":n,role:"menuitem",onMouseOver:L,onKeyUp:c,onKeyDown:x,onFocus:M,tabIndex:0,children:[v&&s.jsx("span",{style:{width:"20px"}}),t&&s.jsx(V,{name:t,className:E["dropdown-item-icon"],appearance:p?"filled":"outlined"}),e?s.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):s.jsx("span",{style:{flex:"2"},children:r}),s.jsx(V,{name:"arrow-chevron-right",className:E["dropdown-item-icon"]})]}),m&&s.jsx("div",{className:E["dropdown-divider"],children:s.jsx(Z,{})})]}),children:y}):s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:E["dropdown-item"],"data-disabled":n,role:"menuitem",onClick:C,onMouseOver:L,onKeyUp:c,onKeyDown:x,onFocus:M,tabIndex:0,...P,children:[v&&!t&&s.jsx("span",{style:{width:"20px"}}),t&&s.jsx(V,{name:t,className:E["dropdown-item-icon"]}),e?s.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):s.jsx("span",{style:{flex:"2"},children:r}),a&&s.jsx("div",{children:a})]}),m&&s.jsx("div",{className:E["dropdown-divider"],children:s.jsx(Z,{})})]})};be.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{ce as D,be as a};

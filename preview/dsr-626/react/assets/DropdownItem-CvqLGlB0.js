import{j as o}from"./jsx-runtime-Cf8x2fCZ.js";import{s as Ee,B as De}from"./Badge-CQk6fGHb.js";import{T as Y,E as Z,b as B,d as ee,c as te,S as re}from"./keyboard.constants-BverKK8B.js";import{r as d}from"./index-G8LIXM5I.js";import{u as le}from"./useActiveKeyboard-DaOmFJe_.js";import{D as W}from"./Divider-cNGLKJiC.js";import{I as X}from"./Icon-DjEid3Hw.js";import{c as ae,b as de,a as ce}from"./auto-placement-C6RxYMtA.js";import{a as Re}from"./dom.constants-41SiyeDe.js";import{u as _e}from"./useAnimatedMount-_zPBpYOt.js";import{O as Ie}from"./Overlay-BI5SO8Nq.js";import{c as $}from"./index-DSdvzt-y.js";const je=150;let j={};const R={};class m{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return j[e]||!1}static open(e){j[e]=!0,this.notifyListeners(e)}static close(e){delete j[e],this.notifyListeners(e)}static closeAll(){j={},Object.values(R).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(j)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(j).filter(s=>s.startsWith(e)&&s!==e).forEach(s=>m.close(s))}static subscribe(e,t){return R[e]||(R[e]=[]),R[e].push(t),()=>{R[e]=R[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=R[e])==null||t.forEach(a=>a())}}const oe=d.createContext(void 0),ue=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>o.jsx(oe.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});ue.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Ce="_trigger_19dwi_1",Ne="_dropdown_19dwi_13",C={trigger:Ce,dropdown:Ne,"dropdown-menu-header":"_dropdown-menu-header_19dwi_39","dropdown-menu-content":"_dropdown-menu-content_19dwi_39","dropdown-menu-footer":"_dropdown-menu-footer_19dwi_39","dropdown-items":"_dropdown-items_19dwi_42"},ie=r=>{var a;const e=me(r),t=e.findIndex(s=>s===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},be=r=>{var a;const e=me(r),t=e.findIndex(s=>s===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},pe=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},Oe=r=>{var s;const e=m.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(s=a==null?void 0:a.querySelector("[data-active=true]"))==null||s.focus()},me=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},fe=r=>{const e=d.useRef(r||m.generateId()),[t,a]=d.useState(!1);d.useEffect(()=>m.subscribe(e.current,()=>{a(m.isOpen(e.current))}),[]);const s=()=>{m.open(e.current)},f=()=>{m.close(e.current)},g=()=>{t?f():s()};return{dropdownId:e.current,isOpen:t,open:s,close:f,toggle:g}},we=d.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:s,position:f="bottom",autoClose:g=!0,isOpen:y=!1,onClose:N=()=>{},children:T,offset:v=0,alignment:S="start",autofocus:A=!0,header:q,footer:L,...b},x)=>{const{dropdownId:i}=fe(a),[z,O]=d.useState(f),{closeRoot:E}=d.useContext(oe)||{},w=d.useRef(null),M=d.useRef(null),[c,Q]=d.useState(null),[D,G]=d.useState(null),[P,K]=d.useState({top:500,left:500}),{shouldRender:k,isAnimating:U}=_e(y,je),p=d.useCallback(n=>{M.current=n,Q(n),typeof x=="function"?x(n):x&&(x.current=n)},[x]),F=d.useCallback(n=>{w.current=n,G(n)},[]),H=d.useCallback(()=>{s&&E?E():N(),m.closeAll()},[E,s,N]),ye=n=>{if(n.key===B||n.key===ee){if(n.stopPropagation(),n.preventDefault(),c===null)return;n.key===B?ie(c):be(c)}},ve=n=>{var l,u;if(n.key===te){H();const h=(l=w.current)==null?void 0:l.querySelectorAll(Re)[0];h?h.focus():(u=w.current)==null||u.focus()}},he=n=>{if(n.key===Y){if(c===null)return;n.preventDefault(),ie(c)}},{onKeyDown:ge,onKeyUp:xe}=le({onKeyUp:ve,onKeyDown:ye},{interactiveKeyCodes:[Z,Y,B,ee,te]});d.useEffect(()=>{const n=l=>{var V;const u=l.target,h=document.querySelectorAll("[data-dropdown-id]");Array.from(h).some(J=>J.contains(u))||((V=w.current)==null?void 0:V.contains(u))||H()};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[H]);const ne=d.useCallback((n,l)=>{const u=ae(n,l,"right",v,!0),h=de(n,l,u),I=ce(u,n,l,v,h);O(u),K(I)},[v]),se=d.useCallback((n,l,u,h)=>{const I=u==="auto"?ae(n,l,"bottom"):u,V=h??de(n,l,I),J=ce(I,n,l,v,V);O(I),K(J)},[v]);return d.useEffect(()=>{!D||!c||(s?ne(D,c):se(D,c,f,S))},[s,c,D,f,S,ne,se]),d.useEffect(()=>{y&&c&&A&&pe(i)},[y,i,c,A]),o.jsxs(ue,{dropdownId:i,closeRoot:H,autoClose:g,children:[o.jsx("div",{ref:F,className:C.trigger,tabIndex:-1,onKeyDown:he,children:r}),k&&o.jsx(Ie,{children:o.jsxs("div",{className:$(C.dropdown,e),"data-dropdown-id":i,"data-position":z,"data-open":U||void 0,...b,style:{...t,top:P.top,left:P.left},ref:p,onKeyUp:xe,onKeyDown:ge,children:[q&&o.jsxs("div",{className:$(C["dropdown-menu-header"],"rte-dropdown-menu-header"),children:[q,o.jsx(W,{})]}),o.jsx("div",{className:$(C["dropdown-menu-content"],"rte-dropdown-menu-content"),children:o.jsx("ul",{className:C["dropdown-items"],role:"menu",children:T})}),L&&o.jsxs("div",{className:$(C["dropdown-menu-footer"],"rte-dropdown-menu-footer"),children:[o.jsx(W,{}),L]})]})})]})});we.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},header:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},footer:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const _={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},Ke=({label:r,link:e,leftIcon:t,trailingText:a,disabled:s,hasSeparator:f,hasIndent:g,children:y,badgeCount:N,badgeContent:T,badgeIcon:v,badgeType:S,badgeSize:A,showBadge:q,isSelected:L,onClick:b,...x})=>{const{dropdownId:i,autoClose:z,closeRoot:O}=d.useContext(oe)||{},E=`${i}-${r&&r.replace(/\s+/g,"")}`,{isOpen:w,open:M}=fe(E),c=()=>{i&&(m.closeSubMenus(i),M())},Q=()=>{i&&m.closeSubMenus(i)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const D=p=>{s||(b&&b(p),z&&O&&O())},G=p=>{if([re,Z].includes(p.key))if(e){const F=p.currentTarget.querySelector("a");F&&F.click()}else{if(s)return;b&&D(p),y&&M()}},P=p=>{p.preventDefault(),p.key===Y&&(w&&pe(E),p.shiftKey&&i&&Oe(i))},{onKeyUp:K,onFocus:k,onKeyDown:U}=le({onKeyUp:P,onFocus:Q,onKeyDown:G},{interactiveKeyCodes:[re,Z,Y,B,ee,te]});return y?o.jsx(we,{hasParent:!0,dropdownId:E,isOpen:w,trigger:o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:_["dropdown-item"],"data-active":w,"data-disabled":s,role:"menuitem",onMouseOver:c,onKeyUp:K,onKeyDown:U,onFocus:k,tabIndex:0,children:[g&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(X,{name:t,className:_["dropdown-item-icon"],appearance:w?"filled":"outlined"}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):o.jsx("span",{style:{flex:"2"},children:r}),o.jsx(X,{name:"arrow-chevron-right",className:_["dropdown-item-icon"]})]}),f&&o.jsx("div",{className:_["dropdown-divider"],children:o.jsx(W,{})})]}),children:y}):o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:_["dropdown-item"],"data-disabled":s,"data-active":L,role:"menuitem",onClick:D,onMouseOver:c,onKeyUp:K,onKeyDown:U,onFocus:k,tabIndex:0,...x,children:[g&&!t&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(X,{name:t,className:_["dropdown-item-icon"]}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):o.jsx("span",{style:{flex:"2"},children:r}),a&&o.jsx("div",{children:a}),Ee({showBadge:!!q,badgeContent:T,badgeCount:N,badgeIcon:v})&&o.jsx(De,{count:N,content:T,icon:v,badgeType:S,size:A})]}),f&&o.jsx("div",{className:_["dropdown-divider"],children:o.jsx(W,{})})]})};Ke.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{we as D,Ke as a};

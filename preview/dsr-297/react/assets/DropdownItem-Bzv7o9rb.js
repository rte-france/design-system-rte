import{j as n}from"./jsx-runtime-Cf8x2fCZ.js";import{s as ge,B as he}from"./Badge-CQk6fGHb.js";import{T as V,S as J,E as Q,b as U,d as X,c as Z}from"./keyboard.constants-BverKK8B.js";import{r as i}from"./index-G8LIXM5I.js";import{u as ce}from"./useActiveKeyboard-DaOmFJe_.js";import{D as ne}from"./Divider-cNGLKJiC.js";import{I as z}from"./Icon-DjEid3Hw.js";import{c as se,b as re,a as ae}from"./auto-placement-C6RxYMtA.js";import{u as xe}from"./useAnimatedMount-_zPBpYOt.js";import{O as Ee}from"./Overlay-CQ0GhNxd.js";import{c as De}from"./index-DSdvzt-y.js";const Ie=150;let R={};const E={};class l{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return R[e]||!1}static open(e){R[e]=!0,this.notifyListeners(e)}static close(e){delete R[e],this.notifyListeners(e)}static closeAll(){R={},Object.values(E).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(R)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(R).filter(s=>s.startsWith(e)&&s!==e).forEach(s=>l.close(s))}static subscribe(e,t){return E[e]||(E[e]=[]),E[e].push(t),()=>{E[e]=E[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=E[e])==null||t.forEach(a=>a())}}const ee=i.createContext(void 0),de=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>n.jsx(ee.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});de.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Re="_trigger_obnza_1",Ce="_dropdown_obnza_13",G={trigger:Re,dropdown:Ce,"dropdown-items":"_dropdown-items_obnza_39"},ie=r=>{var a;const e=ue(r),t=e.findIndex(s=>s===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},je=r=>{var a;const e=ue(r),t=e.findIndex(s=>s===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},le=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},be=r=>{var s;const e=l.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(s=a==null?void 0:a.querySelector("[data-active=true]"))==null||s.focus()},ue=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},pe=r=>{const e=i.useRef(r||l.generateId()),[t,a]=i.useState(!1);i.useEffect(()=>l.subscribe(e.current,()=>{a(l.isOpen(e.current))}),[]);const s=()=>{l.open(e.current)},p=()=>{l.close(e.current)},g=()=>{t?p():s()};return{dropdownId:e.current,isOpen:t,open:s,close:p,toggle:g}},me=i.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:s,position:p="bottom",autoClose:g=!0,isOpen:w=!1,onClose:C=()=>{},children:N,offset:y=0,alignment:A="start",autofocus:S=!0,...$},h)=>{const{dropdownId:v}=pe(a),[F,u]=i.useState(p),{closeRoot:j}=i.useContext(ee)||{},b=i.useRef(null),_=i.useRef(null),[c,T]=i.useState(null),[x,Y]=i.useState(null),[K,L]=i.useState({top:500,left:500}),{shouldRender:B,isAnimating:M}=xe(w,Ie),q=i.useCallback(o=>{_.current=o,T(o),typeof h=="function"?h(o):h&&(h.current=o)},[h]),P=i.useCallback(o=>{b.current=o,Y(o)},[]),d=i.useCallback(()=>{s&&j?j():C(),l.closeAll()},[j,s,C]),k=o=>{if(o.key===U||o.key===X){if(o.stopPropagation(),o.preventDefault(),c===null)return;o.key===U?ie(c):je(c)}},fe=o=>{o.key===Z&&d()},we=o=>{if(o.key===V){if(c===null)return;o.preventDefault(),ie(c)}},{onKeyDown:ye,onKeyUp:ve}=ce({onKeyUp:fe,onKeyDown:k},{interactiveKeyCodes:[J,Q,V,U,X,Z]});i.useEffect(()=>{const o=m=>{var H;const f=m.target,O=document.querySelectorAll("[data-dropdown-id]");Array.from(O).some(W=>W.contains(f))||((H=b.current)==null?void 0:H.contains(f))||d()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[d]);const te=i.useCallback((o,m)=>{const f=se(o,m,"right",y,!0),O=re(o,m,f),I=ae(f,o,m,y,O);u(f),L(I)},[y]),oe=i.useCallback((o,m,f,O)=>{const I=f==="auto"?se(o,m,"bottom"):f,H=O??re(o,m,I),W=ae(I,o,m,y,H);u(I),L(W)},[y]);return i.useEffect(()=>{!x||!c||(s?te(x,c):oe(x,c,p,A))},[s,c,x,p,A,te,oe]),i.useEffect(()=>{w&&c&&S&&le(v)},[w,v,c,S]),n.jsxs(de,{dropdownId:v,closeRoot:d,autoClose:g,children:[n.jsx("div",{ref:P,className:G.trigger,tabIndex:-1,onKeyDown:we,children:r}),B&&n.jsx(Ee,{children:n.jsx("div",{className:De(G.dropdown,e),"data-dropdown-id":v,"data-position":F,"data-open":M||void 0,...$,style:{...t,top:K.top,left:K.left},ref:q,onKeyUp:ve,onKeyDown:ye,children:n.jsx("ul",{className:G["dropdown-items"],role:"menu",children:N})})})]})});me.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const D={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},_e=({label:r,link:e,leftIcon:t,trailingText:a,disabled:s,hasSeparator:p,hasIndent:g,children:w,badgeCount:C,badgeContent:N,badgeIcon:y,badgeType:A,badgeSize:S,showBadge:$,isSelected:h,onClick:v,...F})=>{const{dropdownId:u,autoClose:j,closeRoot:b}=i.useContext(ee)||{},_=`${u}-${r&&r.replace(/\s+/g,"")}`,{isOpen:c,open:T}=pe(_),x=()=>{u&&(l.closeSubMenus(u),T())},Y=()=>{u&&l.closeSubMenus(u)};g&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const K=d=>{s||(v&&v(d),j&&b&&b())},L=d=>{if([J,Q].includes(d.key))if(e){const k=d.currentTarget.querySelector("a");k&&k.click()}else{if(s)return;v&&K(d),w&&T()}},B=d=>{d.preventDefault(),d.key===V&&(c&&le(_),d.shiftKey&&u&&be(u))},{onKeyUp:M,onFocus:q,onKeyDown:P}=ce({onKeyUp:B,onFocus:Y,onKeyDown:L},{interactiveKeyCodes:[J,Q,V,U,X,Z]});return w?n.jsx(me,{hasParent:!0,dropdownId:_,isOpen:c,trigger:n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:D["dropdown-item"],"data-active":c,"data-disabled":s,role:"menuitem",onMouseOver:x,onKeyUp:M,onKeyDown:P,onFocus:q,tabIndex:0,children:[g&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(z,{name:t,className:D["dropdown-item-icon"],appearance:c?"filled":"outlined"}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),n.jsx(z,{name:"arrow-chevron-right",className:D["dropdown-item-icon"]})]}),p&&n.jsx("div",{className:D["dropdown-divider"],children:n.jsx(ne,{})})]}),children:w}):n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:D["dropdown-item"],"data-disabled":s,"data-active":h,role:"menuitem",onClick:K,onMouseOver:x,onKeyUp:M,onKeyDown:P,onFocus:q,tabIndex:0,...F,children:[g&&!t&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(z,{name:t,className:D["dropdown-item-icon"]}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),a&&n.jsx("div",{children:a}),ge({showBadge:!!$,badgeContent:N,badgeCount:C,badgeIcon:y})&&n.jsx(he,{count:C,content:N,icon:y,badgeType:A,size:S})]}),p&&n.jsx("div",{className:D["dropdown-divider"],children:n.jsx(ne,{})})]})};_e.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{me as D,_e as a};

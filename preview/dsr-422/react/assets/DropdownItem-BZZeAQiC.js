import{j as o}from"./jsx-runtime-Cf8x2fCZ.js";import{s as ye,B as ve}from"./Badge-CQk6fGHb.js";import{S as W,E as G,T as J,b as F,d as Q,c as X}from"./keyboard.constants-BverKK8B.js";import{r as c}from"./index-G8LIXM5I.js";import{u as ae}from"./useActiveKeyboard-DaOmFJe_.js";import{D as oe}from"./Divider-cNGLKJiC.js";import{I as B}from"./Icon-DjEid3Hw.js";import{c as ne,b as se,a as re}from"./auto-placement-C6RxYMtA.js";import{u as ge}from"./useAnimatedMount-_zPBpYOt.js";import{O as xe}from"./Overlay-CQ0GhNxd.js";import{c as he}from"./index-DSdvzt-y.js";let K={};const D={};class p{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return K[e]||!1}static open(e){K[e]=!0,this.notifyListeners(e)}static close(e){delete K[e],this.notifyListeners(e)}static closeAll(){K={},Object.values(D).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(K)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(K).filter(n=>n.startsWith(e)&&n!==e).forEach(n=>p.close(n))}static subscribe(e,t){return D[e]||(D[e]=[]),D[e].push(t),()=>{D[e]=D[e].filter(r=>r!==t)}}static notifyListeners(e){var t;(t=D[e])==null||t.forEach(r=>r())}}const Z=c.createContext(void 0),ce=({dropdownId:s,closeRoot:e,autoClose:t=!0,children:r})=>o.jsx(Z.Provider,{value:{dropdownId:s,closeRoot:e,autoClose:t},children:r});ce.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Ee="_trigger_obnza_1",De="_dropdown_obnza_13",z={trigger:Ee,dropdown:De,"dropdown-items":"_dropdown-items_obnza_39"},be=s=>{var r;const e=de(s),t=e.findIndex(n=>n===document.activeElement);t<e.length-1?e[t+1].focus():(r=e[0])==null||r.focus()},Re=s=>{var r;const e=de(s),t=e.findIndex(n=>n===document.activeElement);t>0?e[t-1].focus():(r=e[e.length-1])==null||r.focus()},ie=s=>{var r;const e=s?CSS.escape(s):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((r=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||r.focus())},Ce=s=>{var n;const e=p.getParentDropdownId(s),t=e?CSS.escape(e):null;if(!t)return;const r=document.querySelector(`[data-dropdown-id='${t}']`);(n=r==null?void 0:r.querySelector("[data-active=true]"))==null||n.focus()},de=s=>{const e=s==null?void 0:s.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},le=s=>{const e=c.useRef(s||p.generateId()),[t,r]=c.useState(!1);c.useEffect(()=>p.subscribe(e.current,()=>{r(p.isOpen(e.current))}),[]);const n=()=>{p.open(e.current)},m=()=>{p.close(e.current)},h=()=>{t?m():n()};return{dropdownId:e.current,isOpen:t,open:n,close:m,toggle:h}},ue=c.forwardRef(({trigger:s,className:e,style:t,dropdownId:r,hasParent:n,position:m="bottom",autoClose:h=!0,isOpen:y=!1,onClose:S=()=>{},children:A,offset:v=0,alignment:L="start",autofocus:O=!0,...U},f)=>{const{dropdownId:R}=le(r),[w,q]=c.useState(m),{closeRoot:C}=c.useContext(Z)||{},g=c.useRef(null),I=c.useRef(null),[i,M]=c.useState(null),[j,N]=c.useState(null),[T,P]=c.useState({top:500,left:500}),{shouldRender:k,isAnimating:H}=ge(y,150),V=c.useCallback(a=>{I.current=a,M(a),typeof f=="function"?f(a):f&&(f.current=a)},[f]),u=c.useCallback(a=>{g.current=a,N(a)},[]),E=c.useCallback(()=>{n&&C?C():S(),p.closeAll()},[C,n,S]),pe=a=>{if(a.key===F||a.key===Q){if(a.stopPropagation(),a.preventDefault(),i===null)return;a.key===F?be(i):Re(i)}},me=a=>{var d,l;if(a.key===X){E();const x=(d=g.current)==null?void 0:d.querySelectorAll("button, [role='button'], [tabindex]:not([tabindex='-1'])")[0];x?x.focus():(l=g.current)==null||l.focus()}},{onKeyDown:fe,onKeyUp:we}=ae({onKeyUp:me,onKeyDown:pe},{interactiveKeyCodes:[W,G,J,F,Q,X]});c.useEffect(()=>{const a=d=>{var $;const l=d.target,x=document.querySelectorAll("[data-dropdown-id]");Array.from(x).some(Y=>Y.contains(l))||(($=g.current)==null?void 0:$.contains(l))||E()};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[E]);const ee=c.useCallback((a,d)=>{const l=ne(a,d,"right",v,!0),x=se(a,d,l),_=re(l,a,d,v,x);q(l),P(_)},[v]),te=c.useCallback((a,d,l,x)=>{const _=l==="auto"?ne(a,d,"bottom"):l,$=x??se(a,d,_),Y=re(_,a,d,v,$);q(_),P(Y)},[v]);return c.useEffect(()=>{!j||!i||(n?ee(j,i):te(j,i,m,L))},[n,i,j,m,L,ee,te]),c.useEffect(()=>{y&&i&&O&&ie(R)},[y,R,i,O]),o.jsxs(ce,{dropdownId:R,closeRoot:E,autoClose:h,children:[o.jsx("div",{ref:u,className:z.trigger,tabIndex:-1,children:s}),k&&o.jsx(xe,{children:o.jsx("div",{className:he(z.dropdown,e),"data-dropdown-id":R,"data-position":w,"data-open":H||void 0,...U,style:{...t,top:T.top,left:T.left},ref:V,onKeyUp:we,onKeyDown:fe,children:o.jsx("ul",{className:z["dropdown-items"],role:"menu",children:A})})})]})});ue.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const b={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},Ie=({label:s,link:e,leftIcon:t,trailingText:r,disabled:n,hasSeparator:m,hasIndent:h,children:y,badgeCount:S,badgeContent:A,badgeIcon:v,badgeType:L,badgeSize:O,showBadge:U,onClick:f,...R})=>{const{dropdownId:w,autoClose:q,closeRoot:C}=c.useContext(Z)||{},g=`${w}-${s&&s.replace(/\s+/g,"")}`,{isOpen:I,open:i}=le(g),M=()=>{w&&(p.closeSubMenus(w),i())},j=()=>{w&&p.closeSubMenus(w)};h&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${s}' without indentation.`);const N=u=>{n||(f&&f(u),q&&C&&C())},T=u=>{if([W,G].includes(u.key))if(e){const E=u.currentTarget.querySelector("a");E&&E.click()}else{if(n)return;f&&N(u),y&&i()}},P=u=>{u.preventDefault(),u.key===J&&(I&&ie(g),u.shiftKey&&w&&Ce(w))},{onKeyUp:k,onFocus:H,onKeyDown:V}=ae({onKeyUp:P,onFocus:j,onKeyDown:T},{interactiveKeyCodes:[W,G,J,F,Q,X]});return y?o.jsx(ue,{hasParent:!0,dropdownId:g,isOpen:I,trigger:o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:b["dropdown-item"],"data-active":I,"data-disabled":n,role:"menuitem",onMouseOver:M,onKeyUp:k,onKeyDown:V,onFocus:H,tabIndex:0,children:[h&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(B,{name:t,className:b["dropdown-item-icon"],appearance:I?"filled":"outlined"}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):o.jsx("span",{style:{flex:"2"},children:s}),o.jsx(B,{name:"arrow-chevron-right",className:b["dropdown-item-icon"]})]}),m&&o.jsx("div",{className:b["dropdown-divider"],children:o.jsx(oe,{})})]}),children:y}):o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:b["dropdown-item"],"data-disabled":n,role:"menuitem",onClick:N,onMouseOver:M,onKeyUp:k,onKeyDown:V,onFocus:H,tabIndex:0,...R,children:[h&&!t&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(B,{name:t,className:b["dropdown-item-icon"]}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):o.jsx("span",{style:{flex:"2"},children:s}),r&&o.jsx("div",{children:r}),ye({showBadge:!!U,badgeContent:A,badgeCount:S,badgeIcon:v})&&o.jsx(ve,{count:S,content:A,icon:v,badgeType:L,size:O})]}),m&&o.jsx("div",{className:b["dropdown-divider"],children:o.jsx(oe,{})})]})};Ie.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{ue as D,Ie as a};

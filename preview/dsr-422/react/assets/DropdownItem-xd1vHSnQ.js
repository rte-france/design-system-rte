import{j as n}from"./jsx-runtime-Cf8x2fCZ.js";import{s as ge,B as he}from"./Badge-CQk6fGHb.js";import{T as H,S as G,E as J,b as F,d as X,c as Z}from"./keyboard.constants-BverKK8B.js";import{r as c}from"./index-G8LIXM5I.js";import{u as ie}from"./useActiveKeyboard-DaOmFJe_.js";import{D as ne}from"./Divider-cNGLKJiC.js";import{I as z}from"./Icon-DjEid3Hw.js";import{c as se,b as re,a as ae}from"./auto-placement-C6RxYMtA.js";import{a as xe}from"./dom.constants-41SiyeDe.js";import{u as Ee}from"./useAnimatedMount-_zPBpYOt.js";import{O as De}from"./Overlay-CQ0GhNxd.js";import{c as Re}from"./index-DSdvzt-y.js";const Ie=150;let b={};const R={};class p{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return b[e]||!1}static open(e){b[e]=!0,this.notifyListeners(e)}static close(e){delete b[e],this.notifyListeners(e)}static closeAll(){b={},Object.values(R).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(b)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(b).filter(s=>s.startsWith(e)&&s!==e).forEach(s=>p.close(s))}static subscribe(e,t){return R[e]||(R[e]=[]),R[e].push(t),()=>{R[e]=R[e].filter(a=>a!==t)}}static notifyListeners(e){var t;(t=R[e])==null||t.forEach(a=>a())}}const ee=c.createContext(void 0),de=({dropdownId:r,closeRoot:e,autoClose:t=!0,children:a})=>n.jsx(ee.Provider,{value:{dropdownId:r,closeRoot:e,autoClose:t},children:a});de.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Ce="_trigger_obnza_1",be="_dropdown_obnza_13",Q={trigger:Ce,dropdown:be,"dropdown-items":"_dropdown-items_obnza_39"},ce=r=>{var a;const e=ue(r),t=e.findIndex(s=>s===document.activeElement);t<e.length-1?e[t+1].focus():(a=e[0])==null||a.focus()},je=r=>{var a;const e=ue(r),t=e.findIndex(s=>s===document.activeElement);t>0?e[t-1].focus():(a=e[e.length-1])==null||a.focus()},le=r=>{var a;const e=r?CSS.escape(r):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((a=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||a.focus())},_e=r=>{var s;const e=p.getParentDropdownId(r),t=e?CSS.escape(e):null;if(!t)return;const a=document.querySelector(`[data-dropdown-id='${t}']`);(s=a==null?void 0:a.querySelector("[data-active=true]"))==null||s.focus()},ue=r=>{const e=r==null?void 0:r.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},pe=r=>{const e=c.useRef(r||p.generateId()),[t,a]=c.useState(!1);c.useEffect(()=>p.subscribe(e.current,()=>{a(p.isOpen(e.current))}),[]);const s=()=>{p.open(e.current)},f=()=>{p.close(e.current)},h=()=>{t?f():s()};return{dropdownId:e.current,isOpen:t,open:s,close:f,toggle:h}},me=c.forwardRef(({trigger:r,className:e,style:t,dropdownId:a,hasParent:s,position:f="bottom",autoClose:h=!0,isOpen:w=!1,onClose:j=()=>{},children:S,offset:y=0,alignment:A="start",autofocus:N=!0,...V},x)=>{const{dropdownId:v}=pe(a),[$,m]=c.useState(f),{closeRoot:_}=c.useContext(ee)||{},E=c.useRef(null),O=c.useRef(null),[i,T]=c.useState(null),[D,B]=c.useState(null),[K,L]=c.useState({top:500,left:500}),{shouldRender:Y,isAnimating:M}=Ee(w,Ie),q=c.useCallback(o=>{O.current=o,T(o),typeof x=="function"?x(o):x&&(x.current=o)},[x]),P=c.useCallback(o=>{E.current=o,B(o)},[]),d=c.useCallback(()=>{s&&_?_():j(),p.closeAll()},[_,s,j]),k=o=>{if(o.key===F||o.key===X){if(o.stopPropagation(),o.preventDefault(),i===null)return;o.key===F?ce(i):je(i)}},fe=o=>{var l,u;if(o.key===Z){d();const g=(l=E.current)==null?void 0:l.querySelectorAll(xe)[0];g?g.focus():(u=E.current)==null||u.focus()}},we=o=>{if(o.key===H){if(i===null)return;o.preventDefault(),ce(i)}},{onKeyDown:ye,onKeyUp:ve}=ie({onKeyUp:fe,onKeyDown:k},{interactiveKeyCodes:[G,J,H,F,X,Z]});c.useEffect(()=>{const o=l=>{var U;const u=l.target,g=document.querySelectorAll("[data-dropdown-id]");Array.from(g).some(W=>W.contains(u))||((U=E.current)==null?void 0:U.contains(u))||d()};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[d]);const te=c.useCallback((o,l)=>{const u=se(o,l,"right",y,!0),g=re(o,l,u),C=ae(u,o,l,y,g);m(u),L(C)},[y]),oe=c.useCallback((o,l,u,g)=>{const C=u==="auto"?se(o,l,"bottom"):u,U=g??re(o,l,C),W=ae(C,o,l,y,U);m(C),L(W)},[y]);return c.useEffect(()=>{!D||!i||(s?te(D,i):oe(D,i,f,A))},[s,i,D,f,A,te,oe]),c.useEffect(()=>{w&&i&&N&&le(v)},[w,v,i,N]),n.jsxs(de,{dropdownId:v,closeRoot:d,autoClose:h,children:[n.jsx("div",{ref:P,className:Q.trigger,tabIndex:-1,onKeyDown:we,children:r}),Y&&n.jsx(De,{children:n.jsx("div",{className:Re(Q.dropdown,e),"data-dropdown-id":v,"data-position":$,"data-open":M||void 0,...V,style:{...t,top:K.top,left:K.left},ref:q,onKeyUp:ve,onKeyDown:ye,children:n.jsx("ul",{className:Q["dropdown-items"],role:"menu",children:S})})})]})});me.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const I={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},Oe=({label:r,link:e,leftIcon:t,trailingText:a,disabled:s,hasSeparator:f,hasIndent:h,children:w,badgeCount:j,badgeContent:S,badgeIcon:y,badgeType:A,badgeSize:N,showBadge:V,isSelected:x,onClick:v,...$})=>{const{dropdownId:m,autoClose:_,closeRoot:E}=c.useContext(ee)||{},O=`${m}-${r&&r.replace(/\s+/g,"")}`,{isOpen:i,open:T}=pe(O),D=()=>{m&&(p.closeSubMenus(m),T())},B=()=>{m&&p.closeSubMenus(m)};h&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${r}' without indentation.`);const K=d=>{s||(v&&v(d),_&&E&&E())},L=d=>{if([G,J].includes(d.key))if(e){const k=d.currentTarget.querySelector("a");k&&k.click()}else{if(s)return;v&&K(d),w&&T()}},Y=d=>{d.preventDefault(),d.key===H&&(i&&le(O),d.shiftKey&&m&&_e(m))},{onKeyUp:M,onFocus:q,onKeyDown:P}=ie({onKeyUp:Y,onFocus:B,onKeyDown:L},{interactiveKeyCodes:[G,J,H,F,X,Z]});return w?n.jsx(me,{hasParent:!0,dropdownId:O,isOpen:i,trigger:n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:I["dropdown-item"],"data-active":i,"data-disabled":s,role:"menuitem",onMouseOver:D,onKeyUp:M,onKeyDown:P,onFocus:q,tabIndex:0,children:[h&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(z,{name:t,className:I["dropdown-item-icon"],appearance:i?"filled":"outlined"}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),n.jsx(z,{name:"arrow-chevron-right",className:I["dropdown-item-icon"]})]}),f&&n.jsx("div",{className:I["dropdown-divider"],children:n.jsx(ne,{})})]}),children:w}):n.jsxs(n.Fragment,{children:[n.jsxs("li",{className:I["dropdown-item"],"data-disabled":s,"data-active":x,role:"menuitem",onClick:K,onMouseOver:D,onKeyUp:M,onKeyDown:P,onFocus:q,tabIndex:0,...$,children:[h&&!t&&n.jsx("span",{style:{width:"20px"}}),t&&n.jsx(z,{name:t,className:I["dropdown-item-icon"]}),e?n.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:r}):n.jsx("span",{style:{flex:"2"},children:r}),a&&n.jsx("div",{children:a}),ge({showBadge:!!V,badgeContent:S,badgeCount:j,badgeIcon:y})&&n.jsx(he,{count:j,content:S,icon:y,badgeType:A,size:N})]}),f&&n.jsx("div",{className:I["dropdown-divider"],children:n.jsx(ne,{})})]})};Oe.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{me as D,Oe as a};

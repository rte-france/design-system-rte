import{j as o}from"./jsx-runtime-Cf8x2fCZ.js";import{s as ye,B as ve}from"./Badge-CQk6fGHb.js";import{S as Q,E as G,T as J,b as F,d as X,c as Z}from"./keyboard.constants-BverKK8B.js";import{r as c}from"./index-G8LIXM5I.js";import{u as ce}from"./useActiveKeyboard-DaOmFJe_.js";import{D as ne}from"./Divider-cNGLKJiC.js";import{I as W}from"./Icon-DjEid3Hw.js";import{c as se,b as re,a as ae}from"./auto-placement-C6RxYMtA.js";import{a as ge}from"./dom.constants-41SiyeDe.js";import{u as he}from"./useAnimatedMount-_zPBpYOt.js";import{O as xe}from"./Overlay-CQ0GhNxd.js";import{c as Ee}from"./index-DSdvzt-y.js";const De=150;let b={};const R={};class p{static generateId(){return`dropdown-${Math.random().toString(36).substring(2,9)}`}static isOpen(e){return b[e]||!1}static open(e){b[e]=!0,this.notifyListeners(e)}static close(e){delete b[e],this.notifyListeners(e)}static closeAll(){b={},Object.values(R).flat().forEach(e=>e())}static getOpenedDropdowns(){return Object.keys(b)}static getParentDropdownId(e){const t=e.split("-");return t.length<=2?null:(t.pop(),t.join("-"))}static closeSubMenus(e){Object.keys(b).filter(n=>n.startsWith(e)&&n!==e).forEach(n=>p.close(n))}static subscribe(e,t){return R[e]||(R[e]=[]),R[e].push(t),()=>{R[e]=R[e].filter(r=>r!==t)}}static notifyListeners(e){var t;(t=R[e])==null||t.forEach(r=>r())}}const ee=c.createContext(void 0),ie=({dropdownId:s,closeRoot:e,autoClose:t=!0,children:r})=>o.jsx(ee.Provider,{value:{dropdownId:s,closeRoot:e,autoClose:t},children:r});ie.__docgenInfo={description:"",methods:[],displayName:"DropdownContextProvider",props:{dropdownId:{required:!0,tsType:{name:"string"},description:""},autoClose:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},closeRoot:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Re="_trigger_obnza_1",Ie="_dropdown_obnza_13",z={trigger:Re,dropdown:Ie,"dropdown-items":"_dropdown-items_obnza_39"},Ce=s=>{var r;const e=le(s),t=e.findIndex(n=>n===document.activeElement);t<e.length-1?e[t+1].focus():(r=e[0])==null||r.focus()},be=s=>{var r;const e=le(s),t=e.findIndex(n=>n===document.activeElement);t>0?e[t-1].focus():(r=e[e.length-1])==null||r.focus()},de=s=>{var r;const e=s?CSS.escape(s):null;if(!e)return;const t=document.querySelector(`[data-dropdown-id='${e}']`);t&&((r=(t==null?void 0:t.querySelectorAll('li[role="menuitem"]'))[0])==null||r.focus())},je=s=>{var n;const e=p.getParentDropdownId(s),t=e?CSS.escape(e):null;if(!t)return;const r=document.querySelector(`[data-dropdown-id='${t}']`);(n=r==null?void 0:r.querySelector("[data-active=true]"))==null||n.focus()},le=s=>{const e=s==null?void 0:s.querySelectorAll('li[role="menuitem"]');return e?Array.from(e):[]},ue=s=>{const e=c.useRef(s||p.generateId()),[t,r]=c.useState(!1);c.useEffect(()=>p.subscribe(e.current,()=>{r(p.isOpen(e.current))}),[]);const n=()=>{p.open(e.current)},f=()=>{p.close(e.current)},h=()=>{t?f():n()};return{dropdownId:e.current,isOpen:t,open:n,close:f,toggle:h}},pe=c.forwardRef(({trigger:s,className:e,style:t,dropdownId:r,hasParent:n,position:f="bottom",autoClose:h=!0,isOpen:w=!1,onClose:j=()=>{},children:A,offset:y=0,alignment:K="start",autofocus:N=!0,...H},x)=>{const{dropdownId:v}=ue(r),[V,m]=c.useState(f),{closeRoot:_}=c.useContext(ee)||{},E=c.useRef(null),O=c.useRef(null),[i,T]=c.useState(null),[D,$]=c.useState(null),[S,L]=c.useState({top:500,left:500}),{shouldRender:B,isAnimating:M}=he(w,De),q=c.useCallback(a=>{O.current=a,T(a),typeof x=="function"?x(a):x&&(x.current=a)},[x]),P=c.useCallback(a=>{E.current=a,$(a)},[]),d=c.useCallback(()=>{n&&_?_():j(),p.closeAll()},[_,n,j]),k=a=>{if(a.key===F||a.key===X){if(a.stopPropagation(),a.preventDefault(),i===null)return;a.key===F?Ce(i):be(i)}},me=a=>{var l,u;if(a.key===Z){d();const g=(l=E.current)==null?void 0:l.querySelectorAll(ge)[0];g?g.focus():(u=E.current)==null||u.focus()}},{onKeyDown:fe,onKeyUp:we}=ce({onKeyUp:me,onKeyDown:k},{interactiveKeyCodes:[Q,G,J,F,X,Z]});c.useEffect(()=>{const a=l=>{var U;const u=l.target,g=document.querySelectorAll("[data-dropdown-id]");Array.from(g).some(Y=>Y.contains(u))||((U=E.current)==null?void 0:U.contains(u))||d()};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[d]);const te=c.useCallback((a,l)=>{const u=se(a,l,"right",y,!0),g=re(a,l,u),C=ae(u,a,l,y,g);m(u),L(C)},[y]),oe=c.useCallback((a,l,u,g)=>{const C=u==="auto"?se(a,l,"bottom"):u,U=g??re(a,l,C),Y=ae(C,a,l,y,U);m(C),L(Y)},[y]);return c.useEffect(()=>{!D||!i||(n?te(D,i):oe(D,i,f,K))},[n,i,D,f,K,te,oe]),c.useEffect(()=>{w&&i&&N&&de(v)},[w,v,i,N]),o.jsxs(ie,{dropdownId:v,closeRoot:d,autoClose:h,children:[o.jsx("div",{ref:P,className:z.trigger,tabIndex:-1,children:s}),B&&o.jsx(xe,{children:o.jsx("div",{className:Ee(z.dropdown,e),"data-dropdown-id":v,"data-position":V,"data-open":M||void 0,...H,style:{...t,top:S.top,left:S.left},ref:q,onKeyUp:we,onKeyDown:fe,children:o.jsx("ul",{className:z["dropdown-items"],role:"menu",children:A})})})]})});pe.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{trigger:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},position:{defaultValue:{value:'"bottom"',computed:!1},required:!1},autoClose:{defaultValue:{value:"true",computed:!1},required:!1},isOpen:{defaultValue:{value:"false",computed:!1},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},required:!1},offset:{defaultValue:{value:"0",computed:!1},required:!1},alignment:{defaultValue:{value:'"start"',computed:!1},required:!1},autofocus:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["CoreDropdownProps"]};const I={"dropdown-item":"_dropdown-item_1wyeh_1","dropdown-divider":"_dropdown-divider_1wyeh_38"},_e=({label:s,link:e,leftIcon:t,trailingText:r,disabled:n,hasSeparator:f,hasIndent:h,children:w,badgeCount:j,badgeContent:A,badgeIcon:y,badgeType:K,badgeSize:N,showBadge:H,isSelected:x,onClick:v,...V})=>{const{dropdownId:m,autoClose:_,closeRoot:E}=c.useContext(ee)||{},O=`${m}-${s&&s.replace(/\s+/g,"")}`,{isOpen:i,open:T}=ue(O),D=()=>{m&&(p.closeSubMenus(m),T())},$=()=>{m&&p.closeSubMenus(m)};h&&t&&console.warn(`DropdownItem: 'hasIndent' prop is ignored when 'leftIcon' is provided : displaying icon '${t}' for dropdownitem with label '${s}' without indentation.`);const S=d=>{n||(v&&v(d),_&&E&&E())},L=d=>{if([Q,G].includes(d.key))if(e){const k=d.currentTarget.querySelector("a");k&&k.click()}else{if(n)return;v&&S(d),w&&T()}},B=d=>{d.preventDefault(),d.key===J&&(i&&de(O),d.shiftKey&&m&&je(m))},{onKeyUp:M,onFocus:q,onKeyDown:P}=ce({onKeyUp:B,onFocus:$,onKeyDown:L},{interactiveKeyCodes:[Q,G,J,F,X,Z]});return w?o.jsx(pe,{hasParent:!0,dropdownId:O,isOpen:i,trigger:o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:I["dropdown-item"],"data-active":i,"data-disabled":n,role:"menuitem",onMouseOver:D,onKeyUp:M,onKeyDown:P,onFocus:q,tabIndex:0,children:[h&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(W,{name:t,className:I["dropdown-item-icon"],appearance:i?"filled":"outlined"}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):o.jsx("span",{style:{flex:"2"},children:s}),o.jsx(W,{name:"arrow-chevron-right",className:I["dropdown-item-icon"]})]}),f&&o.jsx("div",{className:I["dropdown-divider"],children:o.jsx(ne,{})})]}),children:w}):o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:I["dropdown-item"],"data-disabled":n,"data-active":x,role:"menuitem",onClick:S,onMouseOver:D,onKeyUp:M,onKeyDown:P,onFocus:q,tabIndex:0,...V,children:[h&&!t&&o.jsx("span",{style:{width:"20px"}}),t&&o.jsx(W,{name:t,className:I["dropdown-item-icon"]}),e?o.jsx("a",{href:e,style:{flex:"2",textDecoration:"none",color:"inherit"},children:s}):o.jsx("span",{style:{flex:"2"},children:s}),r&&o.jsx("div",{children:r}),ye({showBadge:!!H,badgeContent:A,badgeCount:j,badgeIcon:y})&&o.jsx(ve,{count:j,content:A,icon:y,badgeType:K,size:N})]}),f&&o.jsx("div",{className:I["dropdown-divider"],children:o.jsx(ne,{})})]})};_e.__docgenInfo={description:"",methods:[],displayName:"DropdownItem",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>) => void",signature:{arguments:[{type:{name:"union",raw:"React.MouseEvent<HTMLLIElement> | React.KeyboardEvent<HTMLLIElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLLIElement>",elements:[{name:"HTMLLIElement"}]}]},name:"event"}],return:{name:"void"}}},description:""}},composes:["Omit"]};export{pe as D,_e as a};
